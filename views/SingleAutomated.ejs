
<!doctype html>
<html lang="en">
    <head>
        <title><%=name%> || <%=Singlebill.billStatus.toUpperCase()%>/<%=Singlebill.billReferenceNo%>/<%=Singlebill.invoicelocation%>
        </title>
        <!-- Required meta tags -->
        <meta charset="utf-8" />
        <meta
            name="viewport"
            content="width=device-width, initial-scale=1, shrink-to-fit=no"
        />

        <link rel="icon" type="image/x-icon" href="https://allchannels.com.ng/BADES.jpg">

        <!-- Bootstrap CSS v5.2.1 -->
        <link
            href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
            rel="stylesheet"
            integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN"
            crossorigin="anonymous"
        />
        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link href="https://fonts.googleapis.com/css2?family=Dancing+Script&family=Nova+Square&display=swap" rel="stylesheet">
        <style>
         #pspdfkit-header {
  transition: margin-left .5s;
  padding: 16px;
}

@media screen and (max-height: 450px) {
  .sidenav {padding-top: 15px;}
  .sidenav p {font-size: 18px;}
}


      /* ends here  */

      .itemQty:focus{
        outline: none;
      }

      /* #item :nth-child(odd){
        background-color: #999a9c86;
        font-weight: bolder;
        font-size: '15px';
      } */

      @font-face {
        font-family: "Inter";
        src: url("Inter-Regular.ttf") format("truetype");
        font-weight: 400;
        font-style: normal;
      }

      @font-face {
        font-family: "Inter";
        src: url("Inter-Medium.ttf") format("truetype");
        font-weight: 500;
        font-style: normal;
      }

      @font-face {
        font-family: "Inter";
        src: url("Inter-Bold.ttf") format("truetype");
        font-weight: 700;
        font-style: normal;
      }

      #invoice {
        font-size: 0.75rem;
        font-family: "Inter", sans-serif;
        font-weight: 400;
        color: #000000;
        margin: 0 auto;
        position: relative;
      }

      #pspdfkit-header {
        font-size: 0.625rem;
        text-transform: uppercase;
        letter-spacing: 2px;
        font-weight: 400;
        color: #717885;
        margin-top: 2.5rem;
        margin-bottom: 2.5rem;
        width: 100%;
      }

      .header-columns {
        display: flex;
        justify-content: space-between;
        padding-left: 2.5rem;
        padding-right: 2.5rem;
      }

      .logo {
        height: 3rem;
        width: auto;
        margin-right: 1rem;
      }

      .logotype {
        display: flex;
        align-items: center;
        font-weight: 700;
      }

      h2{
        font-family: "Space Mono", monospace;
        font-size: 1.25rem;
        font-weight: 400;
      }

      h4 {
        font-family: "Space Mono", monospace;
        font-size: 1rem;
        font-weight: 400;
      }

      .page {
        margin-left: 5rem;
        margin-right: 5rem;
      }

      .intro-table {
        display: flex;
        justify-content: space-between;
        margin: 3rem 0 3rem 0;
        border-top: 1px solid #000000;
        border-bottom: 1px solid #000000;
      }

      .intro-form {
        display: flex;
        flex-direction: column;
        border-right: 1px solid #000000;
        width: 50%;
      }

      .intro-form:last-child {
        border-right: none;
      }

      .intro-table-title {
        font-size:1rem;
        margin: 0;
      }

      .intro-form-item {
        padding: 1.25rem 1.5rem 1.25rem 1.5rem;
      }

      .intro-form-item:first-child {
        padding-left: 0;
      }

      .intro-form-item:last-child {
        padding-right: 0;
      }

      .intro-form-item-border {
        padding: 1.25rem 0 0.75rem 1.5rem;
        border-bottom: 1px solid #000000;
      }

      .intro-form-item-border:last-child {
        border-bottom: none;
      }

      .form {
        display: flex;
        flex-direction: column;
        margin-top: 6rem;
      }

      .no-border {
        border: none;
      }

      .border {
        border: 1px solid #000000;
      }

      .border-bottom {
        border: 1px solid #000000;
        border-top: none;
        border-left: none;
        border-right: none;
      }

      .signer {
        display: flex;
        justify-content: space-between;
        gap: 2.5rem;
        margin: 2rem 0 2rem 0;
      }

      input {
        font-family: "Space Mono", monospace;
        text-align: center;
        margin-top: none;
        box-sizing: border-box;
        text-align: left;
        border:none !important;
      }

      input#signature {
        height: 8rem;
      }

      .intro-text {
        width: 60%;
      }

      .table-box table,
      .summary-box table {
        width: 100%;
        font-size: 0.625rem;
      }

      .table-box table {
        padding-top: 2rem;
      }

      .table-box td:first-child,
      .summary-box td:first-child {
        width: 40%;
      }

      .table-box td:last-child,
      .summary-box td:last-child {
        text-align: right;
      }

      .table-box table tr.heading td {
        border-top: 1px solid #000000;
        border-bottom: 1px solid #000000;
        height: 1.5rem;
      }

      .table-box table tr.item td,
      .summary-box table tr.item td {
        border-bottom: 1px solid #d7dce4;
        height: 1.5rem;
      }

      .summary-box table tr.no-border-item td {
        border-bottom: none;
        height: 1.5rem;
      }

      .summary-box table tr.total td {
        border-top: 1px solid #000000;
        border-bottom: 1px solid #000000;
        height: 1.5rem;
      }

      .summary-box table tr.item td:first-child,
      .summary-box table tr.total td:first-child {
        border: none;
        height: 1.5rem;
      }

      #pspdfkit-footer {
        font-size: 0.5rem;
        text-transform: uppercase;
        letter-spacing: 1px;
        font-weight: 500;
        color: #717885;
        margin-top: 2.5rem;
        bottom: 2.5rem;
        position: absolute;
        width: 100%;
      }

      .footer-columns {
        display: flex;
        justify-content: space-between;
        padding-left: 2.5rem;
        padding-right: 2.5rem;
      }

      .signer-item img {
        margin:10px;
      }
          .box {
      position: relative;
    }
    .ribbon {
      position: absolute;
      right: -5px; top: -5px;
      z-index: 1;
      overflow: hidden;
      width: 75px; height: 75px;
      text-align: right;
    }
    .ribbon span {
      font-size: 10px;
      font-weight: bold;
      color: #FFF;
      text-transform: uppercase;
      text-align: center;
      line-height: 20px;
      transform: rotate(45deg);
      -webkit-transform: rotate(45deg);
      width: 100px;
      display: block;
      background: #79A70A;
      background: linear-gradient(#9BC90D 0%, #79A70A 100%);
      box-shadow: 0 3px 10px -5px rgba(0, 0, 0, 1);
      position: absolute;
      top: 19px; right: -21px;
    }
    .ribbon span::before {
      content: "";
      position: absolute; left: 0px; top: 100%;
      z-index: -1;
      border-left: 3px solid #79A70A;
      border-right: 3px solid transparent;
      border-bottom: 3px solid transparent;
      border-top: 3px solid #79A70A;
    }
    .ribbon span::after {
      content: "";
      position: absolute; right: 0px; top: 100%;
      z-index: -1;
      border-left: 3px solid transparent;
      border-right: 3px solid #79A70A;
      border-bottom: 3px solid transparent;
      border-top: 3px solid #79A70A;
    }

    /* for canceled bill */
    .CANCELLED {
      position: absolute;
      right: -5px; top: -5px;
      z-index: 1;
      overflow: hidden;
      width: 75px; height: 75px;
      text-align: right;
    }
    .CANCELLED span {
      font-size: 10px;
      font-weight: bold;
      color: #FFF;
      text-transform: uppercase;
      text-align: center;
      line-height: 20px;
      transform: rotate(45deg);
      -webkit-transform: rotate(45deg);
      width: 100px;
      display: block;
      background: #c5160a;
      background: linear-gradient(#df3e0c 0%, #df3e0c 100%);
      box-shadow: 0 3px 10px -5px rgba(0, 0, 0, 1);
      position: absolute;
      top: 19px; right: -21px;
    }
    .CANCELLED span::before {
      content: "";
      position: absolute; left: 0px; top: 100%;
      z-index: -1;
      border-left: 3px solid #df3e0c;
      border-right: 3px solid transparent;
      border-bottom: 3px solid transparent;
      border-top: 3px solid #df3e0c;
    }
    .CANCELLED span::after {
      content: "";
      position: absolute; right: 0px; top: 100%;
      z-index: -1;
      border-left: 3px solid transparent;
      border-right: 3px solid #df3e0c;
      border-bottom: 3px solid transparent;
      border-top: 3px solid #df3e0c;
    }
        </style>

        <link rel="stylesheet" href="/sale.css" />
    </head>
  
    <body onload="">
        <header>
            <%-include('./partials/Notification.ejs')%> 
            <%-include('./partials/invoiceWriteup.ejs')%>
            <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
            <!-- place navbar here -->
            <nav class="dash navbar navbar-light bg-light fixed-top" 
            style="background-color: rgb(173, 168, 105) !important">
                <div class="container-fluid">
                  <span class="navbar-brand" onclick="history.back()" href="/" title="Back">
                    <img 
                    width="30"
                    hegith="30"
                    src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAYAAAA6/NlyAAAACXBIWXMAAAsTAAALEwEAmpwYAAAEgklEQVR4nO2a/U/VVRzH31xEbjxEQmjYAobWUkdYIiYxYYg8c+/9HrqUhAaFbvaE60lnOVzTrRbFMCZjNkmvGV6433NjjY2W1WzrgVHNkq0VtkxXZmqaUwyBTzv0Zd01TO4ZP3zP5b628we8vp/z9P5+DhAkSJAgUw1RyPpWCsN0wOmmUI1TK+Pkzf6IZiCQcbpppqZTO+NEYmicXPX1ZEEgUtpFEYxT97isz2hGoOF0UxTjdGgC2fFKb0Og4HRTLOP0xbVkfcYzUB3NQwmM07eTkCWm0yjj9ChUhXVSisbp2KRk/53aw5pOTqiGndNiptMpf2R9pLdDJRw6ZTBOZ2Rkcxu+PAhAnQuJ5qFcjdNFv2V1Gl2+me8FsBpAJlTAoZNd4zTo9xTWR0bS6/a1GLI2ANEwO4zTGqbTVb9lPcNDd9U2vW7IlgCIgNnROD1pHCl+yTo6hwYXVr60w5AtABAOs6Nx2iSzOdk7rlycX/b0VkN2pfk3KqIQplOjjKyt/dIfibk1zxuyKwCEwuzxjum0R0a27O0LpxMy7Bt9dmNzJ6XCbgpnnDwysqWucyfjFq14zJBNBxACM1PVQ5GM0/sysiV7Tw/EJKetM2TTYHZK3qNZjNNnMrJFu0/0R8xJqTFkF8DsON10i6bTERnZgpZjfdbo+LUAHgQwD2bHzilZ0+kHGdm8nf2fWKyRVQAeAJAIs+P00kJNp5MysrkNfT0WS1glgAoACTA75V5KZzr9LiObveNwl7FeywHEw+yUc8phOv0plXi2dLkMWQ3ALJgdxqlMNvEsrXO1GrJ2JRLPFAmrkXh8CE2rbdro6PhrUGZK29svizuyUtwtpuW84sdfcBwc9H8d/yP+MhQiFECOkE7MrnrW9s6ls1LSnJpVaqFYANwnpOcsKX6qdP952b+PLpWaZSEAlgrpuDsyN5TsO3Nccnq/+3AbWaEQi4V0VOKi2uK2X6WumJpOH9q8pMYxZbBQSEfE31ZduPv4N5JrutehU
                    xwUYr5IPGHRsWvzd33fK1npfpuX5kIhkkTysYRZH1rZeORjSekfHTqZPyb6ICpUAYulMueVzydqbk9m/GLnlAqFmA3gfrGuM7d2H5A8ss5qHroXChErrt5Cetkmz1syP+LHelBeyoNC3Ggko9VLntizS9NHhiXO6Sual0SUVIZI8V5FSKc+0tjg8Fwdkqi0+FDVUAgrgCIhfWdF/XbRM5Ko9CjTqQ4KMRPAKiGdUlr3ot096H+PWMGkNWM8aSXlr99sb798fjo8ebAAyBLSCem2urIDF36bDo9aQgBkjCWtBVkbSl3nfp7sOl72XMcbyvwPm4B7hHRMYuq6krZTA9cTXr6la79Sbzz+P2kl1RS9eeLotWSztn3Qacjmm785fn1uF0krPHZudWHrT1//Vzbn1d4eQ7ZYiWcPkyR5LF5G3LRmVfN3n47L5jUdPWy0ZMoA3IAA41aRtES8zH3tq0MFLQN9RrPNASAKAcrssaRlsVSGWaOrjP6T+VsyU5S0RGfxZkwTYoxqBwkC//gbNIgEXXRi6msAAAAASUVORK5CYII=">
                       <b>QUOTATION/<%=Singlebill.billReferenceNo%>/<%=Singlebill.invoicelocation%>
                       </b>
                    </span>
                    <button
                        class="navbar-toggler"
                        type="button"
                        data-bs-toggle="offcanvas"
                        data-bs-target="#offcanvasNavbar"
                        aria-controls="offcanvasNavbar"
                    >
                    <i class="bi bi-three-dots-vertical"></i>
                    </button>
                    <div
                        class="offcanvas offcanvas-end"
                        tabindex="1"
                        id="offcanvasNavbar"
                        aria-labelledby="offcanvasNavbarLabel"
                        
                    >
                        <div class="offcanvas-header bg-dark-subtle dash "  style="background-color: rgb(173, 168, 105) !important">
                            <h5 class="offcanvas-title" id="offcanvasNavbarLabel">
                                Menu
                            </h5>
                            <button
                                type="button"
                                class="btn-close text-reset"
                                data-bs-dismiss="offcanvas"
                                aria-label="Close"
                            ></button>
                        </div>
                        <div class="offcanvas-body ">
                            <!-- uls -->
                            <ul class="nav nav-tabs d-flex  align-content-center  " id="myTab" role="tablist" >
                              <%-include('./partials/USER.ejs')%>
                                <li class="nav-item " role="presentation">
                                  <button
                                      class="nav-link "
                                      id="profile-tab"
                                      data-bs-toggle="tab"
                                      data-bs-target="#profile"
                                      type="button"
                                      role="tab"
                                      aria-controls="profile"
                                      aria-selected="false"
                                      onclick="generatePdf()"
                                      data-id="<%=Singlebill._id%>"
                                      title="download <%=Singlebill.billStatus%> as Pdf file"
                                  >
                                 <img src="data:image/png;base64,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"
                                    height="30"
                                    width="30"
                                    >
                                  </button>
                                  </li>
                                  <%if(Singlebill.billStatus.toUpperCase() !== 'CANCELLED'){%>
                                  <%if(Singlebill.isDelivered === true && user._id.toString() === warehouse.StoreKeeper._id.toString() || user.isAdmin){%>
                                  <li class="nav-item " role="presentation">
                                    <button
                                        class="nav-link "
                                        data-bs-toggle="tab"
                                        data-bs-target="#profile"
                                        type="button"
                                        role="tab"
                                        aria-controls="profile"
                                        aria-selected="false"
                                        onclick="MailBtn()"
                                        id="Mail" 
                                        data-id="<%=Singlebill._id%>"
                                        title="Mail <%=Singlebill.billStatus%> to <%=cust.Username%>"
                                    >
                                    <svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" fill="currentColor" class="bi bi-envelope-at-fill" viewBox="0 0 16 16">
                                      <path d="M2 2A2 2 0 0 0 .05 3.555L8 8.414l7.95-4.859A2 2 0 0 0 14 2H2Zm-2 9.8V4.698l5.803 3.546L0 11.801Zm6.761-2.97-6.57 4.026A2 2 0 0 0 2 14h6.256A4.493 4.493 0 0 1 8 12.5a4.49 4.49 0 0 1 1.606-3.446l-.367-.225L8 9.586l-1.239-.757ZM16 9.671V4.697l-5.803 3.546.338.208A4.482 4.482 0 0 1 12.5 8c1.414 0 2.675.652 3.5 1.671Z"/>
                                      <path d="M15.834 12.244c0 1.168-.577 2.025-1.587 2.025-.503 0-1.002-.228-1.12-.648h-.043c-.118.416-.543.643-1.015.643-.77 0-1.259-.542-1.259-1.434v-.529c0-.844.481-1.4 1.26-1.4.585 0 .87.333.953.63h.03v-.568h.905v2.19c0 .272.18.42.411.42.315 0 .639-.415.639-1.39v-.118c0-1.277-.95-2.326-2.484-2.326h-.04c-1.582 0-2.64 1.067-2.64 2.724v.157c0 1.867 1.237 2.654 2.57 2.654h.045c.507 0 .935-.07 1.18-.18v.731c-.219.1-.643.175-1.237.175h-.044C10.438 16 9 14.82 9 12.646v-.214C9 10.36 10.421 9 12.485 9h.035c2.12 0 3.314 1.43 3.314 3.034v.21Zm-4.04.21v.227c0 .586.227.8.581.8.31 0 .564-.17.564-.743v-.367c0-.516-.275-.708-.572-.708-.346 0-.573.245-.573.791Z"/>
                                    </svg>
                                    </button>
                                    </li>
                                    <%}%>
                                   <%}%>
                                  <li class="nav-item " role="presentation">
                                    <button
                                        class="nav-link active"
                                        id="profile-tab"
                                        data-bs-toggle="tab"
                                        data-bs-target="#profile"
                                        type="button"
                                        role="tab"
                                        aria-controls="profile"
                                        aria-selected="false"
                                    >
                                    Summary Log
                                  </button>
                                    </li>
                                  <!-- activities on bills modal -->
                                <li  class="list-group">
                                  <h5></h5>
                                      <ul class="list-group list-group-flush">
                                          <div class="list-group">
                                          <%Singlebill.ActivityLog.map(log=>{%>
                                            <!-- Hover added -->
                                              <a class="list-group-item list-group-item-action" >
                                                <%=log.logMsg%>
                                                <b class=" top-0 start-50  badge bg-success shadow"><%=log.status%></b> 
                                              </a >
                                              <%})%>
                                            </div>
                                      </ul>
                                    </li>
            </nav>
            
           <!-- Nav tabs -->
          
        </header>

        <main class="pt-4 ">
           <!-- display single bill -->
           <!-- approve and reject buttons -->
   <div class="">
    <%if(Singlebill.status ==="developer" ){%>
      <button type="button" class="btn btn-success" id="approved" data-id="<%=Singlebill._id%>" onclick="apporved()">
        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-check2-all" viewBox="0 0 16 16">
          <path d="M12.354 4.354a.5.5 0 0 0-.708-.708L5 10.293 1.854 7.146a.5.5 0 1 0-.708.708l3.5 3.5a.5.5 0 0 0 .708 0l7-7zm-4.208 7-.896-.897.707-.707.543.543 6.646-6.647a.5.5 0 0 1 .708.708l-7 7a.5.5 0 0 1-.708 0z"/>
          <path d="m5.354 7.146.896.897-.707.707-.897-.896a.5.5 0 1 1 .708-.708z"/>
        </svg>
        Approve
      </button>
    <button type="button" class="btn btn-danger">
      <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-x-octagon" viewBox="0 0 16 16">
        <path d="M4.54.146A.5.5 0 0 1 4.893 0h6.214a.5.5 0 0 1 .353.146l4.394 4.394a.5.5 0 0 1 .146.353v6.214a.5.5 0 0 1-.146.353l-4.394 4.394a.5.5 0 0 1-.353.146H4.893a.5.5 0 0 1-.353-.146L.146 11.46A.5.5 0 0 1 0 11.107V4.893a.5.5 0 0 1 .146-.353L4.54.146zM5.1 1 1 5.1v5.8L5.1 15h5.8l4.1-4.1V5.1L10.9 1H5.1z"/>
        <path d="M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708z"/>
      </svg>
      Refuse
    </button>
    <%}%>
   </div>
    
    <div  class="shadow-lg p-3 box mt-5 mb-5 container">
      
      
        <div class="ribbon b-gwarning"><span>QUOTATION</span></div>
      <div id="pspdfkit-header " class="table-responsive custom-table-responsive" >

       

          <!-- action buttons -->
     <div class="p-2" >

       <!-- validation work flow -->
     <div class=" d-flex justify-content-end m-0 shadow-sm align-items-center bg-body-tertiary p-2 rounded" >
  
    
      <div class="p-2	" title="Creating" style="background-color:#fff;box-shadow: inset 1px 2px 4px 1px silver; border-radius :50px;" >
        <img width="30" height="30" src="https://img.icons8.com/external-flat-icons-inmotus-design/67/external-New-label-flat-icons-inmotus-design.png" alt="external-New-label-flat-icons-inmotus-design"/>
      </div>
      <div class="p-2 " title="Awaiting delivery"  <%if(Singlebill.status==="Approved" && !Singlebill.isDelivered){%>
        style="background-color:#fff;box-shadow: inset 1px 2px 4px 1px silver; border-radius :50px;" 
        <%}%>><img width="30" height="30" src="/images/icons8-delivery-time.gif" alt="data-pending"/></div>
        <div class="p-2 " title="Delivered"  <%if(Singlebill.isDelivered){%>
          style="background-color:#fff;box-shadow: inset 1px 2px 4px 1px silver;  border-radius: 50px;" 
          <%}%> ><img width="25" height="25" src="/images/icons8-delivery.gif" alt="delivery"/></div>
     </div>
     

     </div>

     <div id="invoice" class="logotype ms-5 border-top border-bottom p-2 table-responsive custom-table-responsive">
      <img  height="80" width="80" src="/logo.jpg" /> 
    </div>
     <div class="header-columns d-flex justify-content-between ">
      <div class="ms-5">
        <h5><%=Business.CompayName%></h5>
            <small>[<%=Business.email%>]</small>
            <p><%=Business.Tel%></p>
            <p><%=Business.Address%></p>
            <p><%=Business.CompanyCity%></p>
            <h5 class="font-bold <%if(Singlebill.billStatus.toUpperCase() === 'CANCELLED'){%>
              text-danger
              <%}%>
                ">QUOTATION/<%=Singlebill.billReferenceNo%>/<%=Singlebill.invoicelocation%></h5>
      </div>

      <div class="me-5">
        <h5><%=cust.Username.toUpperCase()%></h5>
        <p ><a href="tel:<%=cust.phone%>"><%=cust.phone%></a></p>
        <p ><a href="mailto:<%=cust.Email%>"><%=cust.Email%></a></p>
        <p> <%=Singlebill.startDate.toLocaleString()%></p>
      </div>
          
        </div>
      </div>

      <div class="page" >
        <div>
         
          <h2><%=Singlebill.WayBillNo%></h2>
        </div>

        <div class="table-box">
          <table cellpadding="0" cellspacing="0">
            <tr class="heading font-bold">
                <td  >Product</td>
                <td  >Avail.Forecast</td>
                <td  >Batch No:</td>
                <td  >CRTN QTY</td>
                <td  >ROLL QTY</td>
                <td  >Promo</td>
                <td  >VAT</td>
                <td  >Unit Price</td>
                <td  >Total</td>
            </tr>
            <tbody  class="item" id="tbody">
             
              <!-- define all ites in orders here -->
              <%if(Singlebill.orders.length > 0){%>
                    <td>Loading Order content...</td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
              <%}else{%>
                    <td>Order is Empty</td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
              <% } %>
            </tbody>
            <tbody class="item" id="promosection"></tbody>

            </tbody>
          </table>
        </div>

        <div class="summary-box">
          <table cellpadding="10" cellspacing="0">
            <tbody>
              <tr class="item">
                <td></td>
                <td>Subtotal:</td>
                <td id="Subtotal">₦<%=Singlebill.subTotal.toFixed(2)%></td>
              </tr>

              <tr class="item">
                <td></td>
                <td>Discount:</td>
                <td>₦<%=Singlebill.discount.toFixed(2)%></td>
              </tr>

              <tr class="item">
                <td></td>
                <td>Tax Rate:</td>
                <td>₦<%=Singlebill.taxRate%></td>
              </tr> 

              <tr class="no-border-item">
                <td></td>
                <td>Shipping/Handling:</td>
                <td>₦<input type="number" name="" id="Shipping" placeholder="0.00" style="width:50px"value="<%=Singlebill.shippingFee%>" disabled> </td>
              </tr>

              <tr class="total">
                <td></td>
                <td>Total Due:</td>
                <td >₦ <%=Singlebill.grandTotal.toFixed(2)%></td>
               
              </tr>

              <tr class="total">
                <td></td>
                
              </tr>
          </table>
          <input type="hidden" id="Grandtotal" value="<%=Singlebill.grandTotal%>" hidden>
          <p>Total in words:</p>
          <p id="words"></p>
        </div>
      </div>

      <div class="page" style="page-break-after: always">
      
        <div class="page" style="page-break-after: always">
          <div class="signer">
            <div class="form signer-item">
              <label class="border-bottom" for="date" class="label">Terms & Conditions</label>
                <small>WE DON'T ACCEPT CASH,ONLY TRANSFER OR Issue CHEQUE TO ALL CHANNEL DISTRIBUTORS NIG</small>
            </div>

            <div class="form signer-item">
              <label for="signature" class="label">Issued by: <%=Singlebill.RaiseBy%></label>
              <img class="logo" title="Scan to download QUOTATION #S<%=Singlebill.billReferenceNo%>" style="width: 150px; height: 150px;" src="https://raw.githubusercontent.com/edisonneza/jspdf-invoice-template/demo/images/qr_code.jpg"
              id="signature"
            />
            </div>
          </div>
        </div>
        
      </div>

      <div id="pspdfkit-footer" >
        <div class="footer-columns">
          <span>"QUOTATION #S<%=Singlebill.billReferenceNo%>"</span>
        </div>
      </div>
    </div>
    

    
  </div>
        </main>
        <footer style="z-index: 3 !important;">
            <!-- place footer here -->
            <div class="container-fluid fixed-bottom bg-dark-subtle ">
              <div class="row">
                  <div class="col-12">
                      <div class="row">
                          <div class="col-12">
                              <p class="text-center">
                                  BADE &copy; <script>
                                      document.write(new Date().getFullYear());
                                  </script>. All rights reserved.
                              </p>
                          </div>
                      </div>
                  </div>
              </div>
          </div>
            <!-- end of footer -->
           
        </footer>
       

        <!-- Bootstrap JavaScript Libraries -->
        <script
            src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js"
            integrity="sha384-I7E8VVD/ismYTF4hNIPjVp/Zjvgyol6VFvRkX/vR+Vc4jQkC+hVqc2pM8ODewa9r"
            crossorigin="anonymous"
        ></script>

        <script
            src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.min.js"
            integrity="sha384-BBtl+eGJRgqQAUMxJ7pMwbEyER4l1g+O15P+16Ep7Q9Q+zqX6gSbd85u4mG4QzX+"
            crossorigin="anonymous"
        ></script>
        <script src="https://cdn.jsdelivr.net/npm/dayjs@1/dayjs.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.29.4/moment-with-locales.min.js" integrity="sha512-42PE0rd+wZ2hNXftlM78BSehIGzezNeQuzihiBCvUEB3CVxHvsShF86wBWwQORNxNINlBPuq7rG4WWhNiTVHFg==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
        <script src="https://unpkg.com/jspdf-invoice-template@1.4.0/dist/index.js"></script>
        <!-- <script>


      
      let Inwords
      //    /the button
      const  generatePdf = async  function  (){
        const convertAmount = (debt)=>{
            f = new Intl.NumberFormat(undefined,{
              currency:"NGN",
              style:"currency"
            })
            return f.format(debt)
            }

       const billId =  document.getElementById("profile-tab")//download btn AutomatedInvoice
      const id = billId.dataset.id
       const request = await fetch(`/api/v1/Getfulldb`,{
              method:'GET',
              headers:{'Content-Type': 'application/json'},
          })
              const response = await request.json()

      var pdfObject = await jsPDFInvoiceTemplate.default( {
              outputType: jsPDFInvoiceTemplate.OutputType.Save,
              returnJsPDFDocObject: true,
              fileName: `${response.bill.customerName}`,
              orientationLandscape: false,
              compress: true,
              logo: {
              src: "/logo.jpg",
              type: 'JPG', //optional, when src= data:uri (nodejs case)
              width: 26.66, //aspect ratio = width/height
              height: 26.66,
              margin: {
                  top: 0, //negative or positive num, from the current position
                  left: 0 //negative or positive num, from the current position
              }
              },
              stamp: {
                inAllPages: true, //by default = false, just in the last page
                src: "https://raw.githubusercontent.com/edisonneza/jspdf-invoice-template/demo/images/qr_code.jpg",
                type: 'JPG', //optional, when src= data:uri (nodejs case)
                width: 20, //aspect ratio = width/height
                height: 20,
                margin: {
                    top: 0, //negative or positive num, from the current position
                    left: 0 //negative or positive num, from the current position
                }
              },
              business: {
              name: CompanyName.toUpperCase(),
              address: `${Address.toUpperCase()},`,
              email: `${email.toUpperCase()}`,
              email_1: `(${zip}) ${Tel},`,
              phone: `${ShopAddress}.`,
              website: "",
              },
              contact: {
              label:`Invoicer : ${response.bill.RaiseBy}`,
              name: `${response.bill.customerName.toUpperCase()}`,
              address: `Delivery to: ${response.customers.street ? response.customers.street :""}`,
              phone: `${response.customers.phone ? response.customers.phone : ''}`,
              email: `${response.customers.Email ? response.customers.Email : ""}`,
              otherInfo:`DUPLICATE COPY.`,
              },
              invoice: {
              label:`QUOT/${response.bill.billReferenceNo}/${response.bill.invoicelocation}/`,
              num: `${response.bill.WayBillNo ? response.bill.WayBillNo : '' }` ,
              invDate: `Order Date: ${response.bill.startDate}`,
              invGenDate: `Invoice Date: ${response.bill.DELIVERYDATE ? response.bill.DELIVERYDATE.substring(0,10) : ''}`,
              headerBorder: true,
              tableBodyBorder: true,
              additionalRows:true,
              header: [
                {
                  title: "#",
                  style: {
                    width: 10
                  }
                },
                {
                  title: "Product",
                  style: {
                    width: 40
                  }
                },
                {title:'Batch'},
                // {title:'Batch'},
                { title: "Promo"},
                { title: "P-Sum"},
                { title: "Price"},
                { title: " CRTN "},
                { title: "ROLL"},
                { title: "Vat"},
                { title: "Total",style:{
                  width:30
                }}
              ],
              table: response.bill.orders.map((ord,index)=>{
              
                return [index +1, ord.item.Name,ord.BatchId ? ord.BatchId :'',ord.promotionData ? ord.promotionData :0,ord.promotionData ? ord.promotionData * ord.Qty :0,ord.priceListPrice, ord.Qty, ord.ROLQTY ? ord.ROLQTY:'' , ord.item.VAT.$numberDecimal  ? ord.item.VAT.$numberDecimal : ord.item.VAT , convertAmount(ord.total) ]
              }),
              additionalRows: [{
                  col1: 'Total:',
                  col2: convertAmount(145,250.50),
                  col3: 'ALL',
                  style: {
                      fontSize: 14 //optional, default 12
                  }
              },
              {
                  col1: 'VAT:',
                  col2: '20',
                  col3: '%',
                  style: {
                      fontSize: 10 //optional, default 12
                  }
              },
              {
                  col1: 'SubTotal:',
                  col2: '116,199.90',
                  col3: 'ALL',
                  style: {
                      fontSize: 10 //optional, default 12
                  }
              }],
              invDescLabel: `TOTAL :${convertAmount(response.bill.grandTotal)}`,
              invDesc: `(${Inwords})   SubTotal: ${convertAmount(response.bill.subTotal)},    VAT-SUM(7.5%):${convertAmount(0)},  Invoice-Discount :${convertAmount(response.bill.discount)}, Sum on SKU Promo: NGN${response.bill.orders.map(promo =>{return promo.promotionData * promo.Qty}).reduce((total , currentValue) => {return total + currentValue},0)}`,
              invTotal: convertAmount(response.bill.grandTotal)
              },
              footer: {
              text: InvoicePolicy ,
              },
              pageEnable: true,
              pageLabel: "BADE ",
              }); //returns number of pages created
        }
      
      
          const apporved = async () =>{
            const approveBtn = document.getElementById('approved')
            const id = approveBtn.dataset.id
            const api = `/api/v1/bill/${id}/approved`
      
            const request = await fetch(api,{
              method:'PATCH',
              headers:{"content-type": "application/json"}
            })
            const response = await request.json()
      
            if(response.message){
              ShowServerResponse(response.message)
              location.reload()
            }
          }
       
          ////////////////////////////////////////////////////////////////send mail functionality////////////////////////////////
          const MailBtn = async ()=>{
            const MailBtn = document.getElementById('Mail')
            const id = MailBtn.dataset.id
            const api = `/api/v1/sendmail/${id}/${ActiveUserName}`
            
            const request = await fetch(api,{
              method:'GET',
              headers:{"content-type": "application/json"}
            })
            const response = await request.json()
            
            if (response.message) {
              ShowServerResponse(response.message);
              location.reload()
            }
            if (response.error) serverError(response.error)
          }
      
      const Grandtotal = document.getElementById('Grandtotal').value
      
          function test(n) {
          if (n < 0)
            return false;
         single_digit = ['', 'One', 'Two', 'Three', 'Four', 'Five', 'Six', 'Seven', 'Eight', 'Nine']
         double_digit = ['Ten', 'Eleven', 'Twelve', 'Thirteen', 'Fourteen', 'Fifteen', 'Sixteen', 'Seventeen', 'Eighteen', 'Nineteen']
         below_hundred = ['Twenty', 'Thirty', 'Forty', 'Fifty', 'Sixty', 'Seventy', 'Eighty', 'Ninety']
        if (n === 0) return 'Zero'
        function translate(n) {
          word = ""
          if (n < 10) {
            word = single_digit[n] + ' '
          }
          else if (n < 20) {
            word = double_digit[n - 10] + ' '
          }
          else if (n < 100) {
            rem = translate(n % 10)
            word = below_hundred[(n - n % 10) / 10 - 2] + ' ' + rem
          }
          else if (n < 1000) {
            word = single_digit[Math.trunc(n / 100)] + ' Hundred ' + translate(n % 100)
          }
          else if (n < 1000000) {
            word = translate(parseInt(n / 1000)).trim() + ' Thousand ' + translate(n % 1000)
          }
          else if (n < 1000000000) {
            word = translate(parseInt(n / 1000000)).trim() + ' Million ' + translate(n % 1000000)
          }
          else {
            word = translate(parseInt(n / 1000000000)).trim() + ' Billion ' + translate(n % 1000000000)
          }
          return word
        }
         result = translate(n) 
        return result.trim()+'.'
      }
      document.getElementById('words').innerHTML = `${test(parseInt(Grandtotal))} Naira only.`;
      Inwords =  `${test(parseInt(Grandtotal))} Naira only.`
        


      //dom manipulation


    </script> -->
    </body>
    <!-- <script>

        //add your code here
      const  getInvoice = async () =>{
        plsWait(true);
        const billId =  document.getElementById("profile-tab")//download btn AutomatedInvoice
      const id = billId.dataset.id
       const request = await fetch(`/api/v1/Getfulldb`,{
              method:'GET',
              headers:{'Content-Type': 'application/json'},
          })
        const response = await request.json()
        plsWait(false);
        let invoice = response.SmartInvoice.filter((orders) =>{
            return orders._id === id
        })
        console.log(invoice)
        
        const  RenderDom = (invoice)=>{
            const tbody = document.getElementById('tbody')
            tbody.innerHTML = ''
                if(invoice[0].orders.length > 0){
                    invoice[0].orders.forEach((element)=>{
                        let tr = document.createElement('tr')
                        tr.classList.add('border-bottom')
                        
                        let td2 = document.createElement('td')//product name
                        let Forecast = document.createElement('td')//product name
                        let Batch = document.createElement('td')//product name
                        let td8 = document.createElement('td')//product availability
                        // let scale = document.createElement('td')
                        let td3 = document.createElement('td')// qty
                        let td4 = document.createElement('td')//umo
                        let td5 = document.createElement('td')//vat
                        let td6 = document.createElement('td')//price
                        let td7 = document.createElement('td')//total
                        let promotion = document.createElement('td')//total

                        //assign values to each element and input that can stillbe edited
              td2.innerText = element.item.Name.toUpperCase()
              Forecast.innerText =`C:${element.CRT}, R:${element.ROL}`
              promotion.innerText = `₦${element.promotionData}`
              td2.setAttribute("title", `Double click here to delete ${element.item.Name.toUpperCase()}`)
              Batch.innerText = element.BatchId.toUpperCase()
              //remove item from quotation table
              
              const deleteItem =()=>{
                
                // let index =invoice.orders.findIndex(item =>{
                //   return item === element
                // })
                // if(index > -1){
                
                //   try {
                //     invoice.orders.splice(index,1)
                //     RenderDom(invoice)
    
                //     //calculate  sum of available prices in orders
                //     invoice.subTotal = parseInt(invoice.orders.map(item => {return item.total})
                //     .reduce((total , currentValue) => {return total + currentValue},0))
    
                //     //calculate vat
                //     invoice.taxRate =   parseInt(invoice.orders.map(item => {return (item.total * item.item.VAT.$numberDecimal / 100)})
                //     .reduce((total , currentValue) => {return total + currentValue},0))
    
                //     invoice.grandTotal = invoice.subTotal - parseInt(invoice.discount) 
                //     Grandtotal.textContent = `₦${invoice.grandTotal}`;
    
                //     alert("products removed successfully")
                //     document.getElementById('Subtotal').innerHTML = `₦${invoice.subTotal}`; 
                //     document.getElementById('vat').innerHTML = `₦${invoice.taxRate}`; 
                //   } catch (error) {
                //     ShowServerResponse(error.message)
                //   }
                 
                // }
              }
              td2.ondblclick = deleteItem
    
              //declear qty of products
              let td3Input = document.createElement('input')
              td3Input.value = element.ROLQTY 
    
              //declear SCALE  of products
              let td4Select = document.createElement('input')
              td4Select.value = element.Qty
              td4Select.setAttribute('type', 'number')// for qty
              td4Select.style.border = 'none'
              td4Select.style.width='60px'
              td4Select.setAttribute('required', true)
              td4Select.style.fontSize='10px'
              td4Select.setAttribute('placeholder','CRTN Qty')
              td4Select.classList.add('itemQty')
    
              // ADD Eventlistner for html select
              td4Select.addEventListener('change',(e)=>{//inpur for crtn
                e.target.value === '' ?  e.target.value = 0 : e.target.value 
                const value = parseInt(e.target.value) < 0 ? element.ROLQTY = 0 : e.target.value
              //  SET value of crtn to e
                if(value <= element.CRT){
                  element.Qty = parseInt(value)

                  const CRTNtOTAL =  element.priceListPrice * value
                  const RollToral =  ( element.priceListPrice / element.item.Rolls) * parseInt(element.ROLQTY) 
                  const promo = element.promotionData * element.Qty // no promo on 
                  const CRTNVat = Math.round(parseInt(CRTNtOTAL.toFixed(2) *  element.item.VAT.$numberDecimal)/100)//find single vat for each product qty to perform
                  const ROLLVat = Math.round(parseInt(RollToral.toFixed(2) *  element.item.VAT.$numberDecimal)/100)//find single vat for each product qty to perform
                  element.total = CRTNtOTAL + RollToral + ROLLVat + CRTNVat - promo
                //   calculateTotals(invoice)
                //   RenderDom(invoice)
                }else{
                  serverError(`CRTN Qty should be less than or equal to ${element.CRT}. You cant sell what you dont have`)
                  e.target.value = 0
                  element.Qty = 0
                  deleteItem()
                //   calculateTotals(invoice)
                //   RenderDom(invoice)
                }

              })
    
              // scale.innerText = element.scale
    
              td7.innerText= `₦${element.total.toFixed(2)}`
              

              td3Input.setAttribute('type', 'number')// for qty
              td3Input.setAttribute('required', 'true')// for qty
    
              td3Input.addEventListener('change', async (e)=>{//input for Roll
                e.target.value === '' ?  e.target.value = 0 : e.target.value 
               const value =  parseInt(e.target.value) < 0 ? td3Input.value = 0 : e.target.value
                if(value > element.item.Rolls){
                  serverError(`Defined ${element.item.Rolls} Rolls is lesser than ${value} Rolls Entered, maybe you should pick in CRTNS`)
                  deleteItem()
                //   calculateTotals(invoice)
                //   RenderDom(invoice)
                }else if(element.CRT < 1 && value > element.ROL){
                  serverError(`Available ${element.ROL}Roll is lesser than ${value} Rolls Entered, There are also no CRTNS to Open`)
                  deleteItem()
                //   calculateTotals(invoice)
                //   RenderDom(invoice)
                }else {
                  element.ROLQTY = parseInt(value)
                  const CRTNtOTAL =  element.priceListPrice * element.Qty
                  const RollToral =  ( element.priceListPrice / element.item.Rolls) * parseInt(value) 
                  const promo = (element.promotionData /element.item.Rolls) * element.ROLQTY
                  const CRTNVat = Math.round(parseInt(CRTNtOTAL.toFixed(2) *  element.item.VAT.$numberDecimal)/100)//find single vat for each product qty to perform
                  const singleVat = Math.round(parseInt(RollToral.toFixed(2) *  element.item.VAT.$numberDecimal)/100)//find single vat for each product qty to perform
                  element.total = CRTNtOTAL + RollToral + singleVat + CRTNVat - promo
                //   calculateTotals(invoice)
                //   RenderDom(invoice)
                }
               
              })
            //   calculateTotals(invoice)
    
              td3Input.setAttribute('placeholder','ROLL Qty')
              td3Input.style.width='60px'
              td3Input.style.fontSize='10px'
              td3.appendChild(td3Input)
    
              // td4.innerText = element.item.UMO
              td5.textContent = `${element.item.VAT.$numberDecimal}%`
    
              td6.textContent=  `₦${Math.round(element.priceListPrice.toFixed(2))}`
    
              //assign class
              tr.classList.add('item')
              td3Input.classList.add('itemQty')
    
              //append to quotation 
              tr.appendChild(td2)
              tr.appendChild(Forecast)
              tr.appendChild(Batch)
              tr.appendChild(td4Select)
              // tr.appendChild(scale)
              tr.appendChild(td3)
              tr.appendChild(promotion)
              tr.appendChild(td5)
              tr.appendChild(td6)
              tr.appendChild(td7)
              tbody.appendChild(tr)
            });

             //calculate  sum of available prices in orders
            //  invoice.subTotal = parseInt(invoice.orders.map(item => {return item.total})
            //         .reduce((total , currentValue) => {return total + currentValue},0))
    
            //         //calculate vat
            //         invoice.taxRate =   parseInt(invoice.orders.map(item => {return (item.total * item.item.VAT.$numberDecimal / 100)})
            //         .reduce((total , currentValue) => {return total + currentValue},0))
    
            //         invoice.grandTotal = invoice.subTotal - parseInt(invoice.discount) 
            //         Grandtotal.textContent = `₦${invoice.grandTotal}`;

            //         document.getElementById('Subtotal').innerHTML = `₦${invoice.subTotal}`; 
            //         document.getElementById('vat').innerHTML = `₦${invoice.taxRate}`;
                    
                    
                }
        }

        RenderDom(invoice)
        
      }
    </script> -->
    <script>

const  RenderDom = (invoice)=>{
  // console.log(invoice)
            const tbody = document.getElementById('tbody')
            tbody.innerHTML = ''
                if(invoice.orders.length > 0){
                    invoice.orders.map((element)=>{
                        let tr = document.createElement('tr')
                        tr.classList.add('border-bottom')
                        
                        let td2 = document.createElement('td')//product name
                        let Forecast = document.createElement('td')//product name
                        let Batch = document.createElement('td')//product name
                        let td8 = document.createElement('td')//product availability
                        // let scale = document.createElement('td')
                        let td3 = document.createElement('td')// qty
                        let td4 = document.createElement('td')//umo
                        let td5 = document.createElement('td')//vat
                        let td6 = document.createElement('td')//price
                        let td7 = document.createElement('td')//total
                        let promotion = document.createElement('td')//total

                        //assign values to each element and input that can stillbe edited
              td2.innerText = element.item.Name.toUpperCase()
              Forecast.innerText =`C:${element.CRT}, R:${element.ROL}`
              promotion.innerText = `₦${element.promotionData}`
              td2.setAttribute("title", `Double click here to delete ${element.item.Name.toUpperCase()}`)
              Batch.innerText = element.BatchId.toUpperCase()
              //remove item from quotation table
              
              const deleteItem =()=>{
                
                // let index =invoice.orders.findIndex(item =>{
                //   return item === element
                // })
                // if(index > -1){
                
                //   try {
                //     invoice.orders.splice(index,1)
                //     RenderDom(invoice)
    
                //     //calculate  sum of available prices in orders
                //     invoice.subTotal = parseInt(invoice.orders.map(item => {return item.total})
                //     .reduce((total , currentValue) => {return total + currentValue},0))
    
                //     //calculate vat
                //     invoice.taxRate =   parseInt(invoice.orders.map(item => {return (item.total * item.item.VAT.$numberDecimal / 100)})
                //     .reduce((total , currentValue) => {return total + currentValue},0))
    
                //     invoice.grandTotal = invoice.subTotal - parseInt(invoice.discount) 
                //     Grandtotal.textContent = `₦${invoice.grandTotal}`;
    
                //     alert("products removed successfully")
                //     document.getElementById('Subtotal').innerHTML = `₦${invoice.subTotal}`; 
                //     document.getElementById('vat').innerHTML = `₦${invoice.taxRate}`; 
                //   } catch (error) {
                //     ShowServerResponse(error.message)
                //   }
                 
                // }
              }
              td2.ondblclick = deleteItem
    
              //declear qty of products
              let td3Input = document.createElement('input')
              td3Input.value = element.ROLQTY 
    
              //declear SCALE  of products
              let td4Select = document.createElement('input')
              invoice.status === 'open'? td4Select.setAttribute('disabled',true)  : ''
              
              td4Select.value = element.Qty
              td4Select.setAttribute('type', 'number')// for qty
              td4Select.style.border = 'none'
              td4Select.style.width='60px'
              td4Select.setAttribute('required', true)
              td4Select.style.fontSize='10px'
              td4Select.setAttribute('placeholder','CRTN Qty')
              td4Select.classList.add('itemQty')
    
              // ADD Eventlistner for html select
              td4Select.addEventListener('change',(e)=>{//inpur for crtn
                e.target.value === '' ?  e.target.value = 0 : e.target.value 
                const value = parseInt(e.target.value) < 0 ? element.ROLQTY = 0 : e.target.value
              //  SET value of crtn to e
                if(value <= element.CRT){
                  element.Qty = parseInt(value)

                  const CRTNtOTAL =  element.priceListPrice * value
                  const RollToral =  ( element.priceListPrice / element.item.Rolls) * parseInt(element.ROLQTY) 
                  const promo = element.promotionData * element.Qty // no promo on 
                  const CRTNVat = Math.round(parseInt(CRTNtOTAL.toFixed(2) *  element.item.VAT.$numberDecimal)/100)//find single vat for each product qty to perform
                  const ROLLVat = Math.round(parseInt(RollToral.toFixed(2) *  element.item.VAT.$numberDecimal)/100)//find single vat for each product qty to perform
                  element.total = CRTNtOTAL + RollToral + ROLLVat + CRTNVat - promo
                //   calculateTotals(invoice)
                //   RenderDom(invoice)
                }else{
                  serverError(`CRTN Qty should be less than or equal to ${element.CRT}. You cant sell what you dont have`)
                  e.target.value = 0
                  element.Qty = 0
                  deleteItem()
                //   calculateTotals(invoice)
                //   RenderDom(invoice)
                }

              })
    
              // scale.innerText = element.scale
    
              td7.innerText= `₦${element.total.toFixed(2)}`
              invoice.status === 'open'? td3Input.setAttribute('disabled', true)  :""
              td3Input.setAttribute('type', 'number')// for qty
              td3Input.setAttribute('required', 'true')// for qty
    
              td3Input.addEventListener('change', async (e)=>{//input for Roll
                e.target.value === '' ?  e.target.value = 0 : e.target.value 
               const value =  parseInt(e.target.value) < 0 ? td3Input.value = 0 : e.target.value
                if(value > element.item.Rolls){
                  serverError(`Defined ${element.item.Rolls} Rolls is lesser than ${value} Rolls Entered, maybe you should pick in CRTNS`)
                  deleteItem()
                //   calculateTotals(invoice)
                //   RenderDom(invoice)
                }else if(element.CRT < 1 && value > element.ROL){
                  serverError(`Available ${element.ROL}Roll is lesser than ${value} Rolls Entered, There are also no CRTNS to Open`)
                  deleteItem()
                //   calculateTotals(invoice)
                //   RenderDom(invoice)
                }else {
                  element.ROLQTY = parseInt(value)
                  const CRTNtOTAL =  element.priceListPrice * element.Qty
                  const RollToral =  ( element.priceListPrice / element.item.Rolls) * parseInt(value) 
                  const promo = (element.promotionData /element.item.Rolls) * element.ROLQTY
                  const CRTNVat = Math.round(parseInt(CRTNtOTAL.toFixed(2) *  element.item.VAT.$numberDecimal)/100)//find single vat for each product qty to perform
                  const singleVat = Math.round(parseInt(RollToral.toFixed(2) *  element.item.VAT.$numberDecimal)/100)//find single vat for each product qty to perform
                  element.total = CRTNtOTAL + RollToral + singleVat + CRTNVat - promo
                //   calculateTotals(invoice)
                //   RenderDom(invoice)
                }
               
              })
            //   calculateTotals(invoice)
    
              td3Input.setAttribute('placeholder','ROLL Qty')
              td3Input.style.width='60px'
              td3Input.style.fontSize='10px'
              td3.appendChild(td3Input)
    
              // td4.innerText = element.item.UMO
              td5.textContent = `${element.item.VAT.$numberDecimal}%`
    
              td6.textContent=  `₦${Math.round(element.priceListPrice.toFixed(2))}`
    
              //assign class
              tr.classList.add('item')
              td3Input.classList.add('itemQty')
    
              //append to quotation 
              tr.appendChild(td2)
              tr.appendChild(Forecast)
              tr.appendChild(Batch)
              tr.appendChild(td4Select)
              // tr.appendChild(scale)
              tr.appendChild(td3)
              tr.appendChild(promotion)
              tr.appendChild(td5)
              tr.appendChild(td6)
              tr.appendChild(td7)
              tbody.appendChild(tr)
            });

             //calculate  sum of available prices in orders
            //  invoice.subTotal = parseInt(invoice.orders.map(item => {return item.total})
            //         .reduce((total , currentValue) => {return total + currentValue},0))
    
            //         //calculate vat
            //         invoice.taxRate =   parseInt(invoice.orders.map(item => {return (item.total * item.item.VAT.$numberDecimal / 100)})
            //         .reduce((total , currentValue) => {return total + currentValue},0))
    
            //         invoice.grandTotal = invoice.subTotal - parseInt(invoice.discount) 
            //         Grandtotal.textContent = `₦${invoice.grandTotal}`;

            //         document.getElementById('Subtotal').innerHTML = `₦${invoice.subTotal}`; 
            //         document.getElementById('vat').innerHTML = `₦${invoice.taxRate}`;
                    
                    
                }
        }



      let invoiceStats
     const intervalID =  setInterval(async()=>{
        const Id = location.search
        const client = await fetch(`/api/v1/smartinvoice/${Id}`,{
            method:'GET',
            headers: {'Content-Type': 'application/json'},
        })
        const serverResponse = await client.json()
        RenderDom(serverResponse.Invoice)
        invoiceStats = serverResponse.Invoice.status
        

        },3000)

        setTimeout(()=>{
        invoiceStats !== 'open'? clearInterval(intervalID) : ""
        },4000)
    </script>
    </html>