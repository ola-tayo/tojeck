
<!doctype html>
<html lang="en">
    <head>
        <title><%=name%> || EXP/<%=expense.category%>/<%=expense.refNo%>/<%=expense.Date%></title>
        <!-- Required meta tags -->
        <meta charset="utf-8" />
        <meta
            name="viewport"
            content="width=device-width, initial-scale=1, shrink-to-fit=no"
        />
        <link rel="icon" type="image/x-icon" href="https://allchannels.com.ng/BADES.jpg">
        <!-- Bootstrap CSS v5.2.1 -->
        <link
            href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
            rel="stylesheet"
            integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN"
            crossorigin="anonymous"
        />
        <style>
          h3 {
   color: #262626;
   font-size: 17px;
   line-height: 24px;
   font-weight: 700;
   margin-bottom: 4px;
 }
 
 p {
   font-size: 17px;
   font-weight: 400;
   line-height: 20px;
   color: #666666;
 
   &.small {
     font-size: 14px;
   }
 }
 
 .go-corner {
   display: flex;
   align-items: center;
   justify-content: center;
   position: absolute;
   width: 32px;
   height: 32px;
   overflow: hidden;
   top: 0;
   right: 0;
   background-color: #00838d;
   border-radius: 0 4px 0 32px;
 }
 
 .go-arrow {
   margin-top: -4px;
   margin-right: -4px;
   color: white;
   font-family: courier, sans;
 }
 
 .card1 {
   display: block;
   position: relative;
   max-width: 262px;
   background-color: #f2f8f9;
   border-radius: 4px;
   padding: 32px 24px;
   margin: 12px;
   text-decoration: none;
   z-index: 0;
   overflow: hidden;
 
   &:before {
     content: "";
     position: absolute;
     z-index: -1;
     top: -16px;
     right: -16px;
     background: #00838d;
     height: 32px;
     width: 32px;
     border-radius: 32px;
     transform: scale(1);
     transform-origin: 50% 50%;
     transition: transform 0.25s ease-out;
   }
 
   &:hover:before {
     transform: scale(21);
   }
 }
 
 .card1:hover {
   p {
     transition: all 0.3s ease-out;
     color: rgba(255, 255, 255, 0.8);
   }
   h3 {
     transition: all 0.3s ease-out;
     color: #ffffff;
   }
 }
 
 /* card 2 */
 .card2 {
   display: block;
   top: 0px;
   position: relative;
   max-width: 262px;
   background-color: #f2f8f9;
   border-radius: 4px;
   padding: 32px 24px;
   margin: 12px;
   text-decoration: none;
   z-index: 0;
   overflow: hidden;
   border: 1px solid #f2f8f9;
 
   &:hover {
     transition: all 0.2s ease-out;
     box-shadow: 0px 4px 8px rgba(38, 38, 38, 0.2);
     top: -4px;
     border: 1px solid #cccccc;
     background-color: white;
   }
 
   &:before {
     content: "";
     position: absolute;
     z-index: -1;
     top: -16px;
     right: -16px;
     background: #00838d;
     height: 32px;
     width: 32px;
     border-radius: 32px;
     transform: scale(2);
     transform-origin: 50% 50%;
     transition: transform 0.15s ease-out;
   }
 
   &:hover:before {
     transform: scale(2.15);
   }
 }

 
/* this is for the back flap of the folder */
.folder{
	-webkit-perspective: 400px;
	perspective: 400px;
	width: 120px;
	height: 20px;
	background: #ffd480;
	position: relative;
	top: 50%;
	left: 50%;
	-webkit-transform: translate(-50%, -50%);
	transform: translate(-50%, -50%);
	border-top-right-radius: 5px;
	cursor: pointer;
	-webkit-transition: all 300ms ease;
	transition: all 300ms ease;
  z-index: -1;
}
/* this is for the folder's tab */
.folder::before{
	width: 40px;
	height: 20px;
	content: '';
	background: #ffd480;
	position: absolute;
	top: -20px;
	border-top-left-radius: 5px;
	border-top-right-radius: 5px;
}
/* this is for the folder's front flap */
.folder::after{
	width: 120px;
	height: 80px;
	position: absolute;
	content: '';
	background: #ffcb66;
	top: 20px;
	box-shadow: 0 0 20px 2px rgba(0, 0, 0, 0.3);
	border-top-left-radius: 5px;
	border-top-right-radius: 5px;
	/* the transform property rotates the front flap of the folder a bit t0 make it look 3D */
	-webkit-transform: rotateX(-10deg);
	transform: rotateX(-10deg);
	-webkit-transition: all 400ms ease;
	transition: all 400ms ease;
}
/* this is for the piece of paper inside the folder */
.folder-inside{
	width: 115px;
	height: 70px;
	position: absolute;
	background: #fff;
	top:10px;
	left: 9px;
	box-shadow: 0 0 5px 5px rgba(0, 0, 0, 0.05);
	-webkit-transform: rotate(-1deg);
	transform: rotate(-1deg);
	border: 1px solid #ddd;
	-webkit-transition: all 200ms ease;
	transition: all 200ms ease;
}
/* this is for the lines on the paper */
.folder-inside::before{
	content: '';
	/* we're going to use linear gradients to create the lines */
	background: -webkit-repeating-linear-gradient(145deg, #ffffff, #ffffff 10px, #333333 7px, #333333 20px);
	background: repeating-linear-gradient(0deg, #ffffff, #ffffff 10px, #333333 10px, #333333 20px);
	position: absolute;
	top: 2px;
	left: 65px;
	width: 50px;
	height: 50px;
	color: #343434;
	font-size: 60px;
	line-height: 60px;
	-webkit-transform: rotate(-90deg);
	transform: rotate(-90deg);
	opacity: 0.15;
}
/* finally let's get this folder to rotate when we hover on it */
.folder:hover{
	-webkit-transform: translate(-50%, -52%);
	transform: translate(-50%, -52%);
}
.folder:hover::after{
	-webkit-transform: rotateX(-15deg);
	transform: rotateX(-15deg);
}
.folder:hover .folder-inside{
	-webkit-transform: rotate(-7deg) translateY(-15%);
	transform: rotate(-7deg) translateY(-15%);
}
/* hover over the folder to see the effect in action */
     </style>
    </head>
  
    <body>
        <header>
            <%-include('./partials/Notification.ejs')%> 
            <%-include('./partials/inactive.ejs')%>
            <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
            <!-- place navbar here -->
            <link rel="stylesheet" href="/sale.css" />
            <nav class=" dash navbar navbar-light bg-light fixed-top">
                <div class="container-fluid">
                    <span  class="navbar-brand" >
                        <img 
                        onclick="history.back()"
                        width="30"
                        hegith="30"
                        src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAYAAAA6/NlyAAAACXBIWXMAAAsTAAALEwEAmpwYAAAEgklEQVR4nO2a/U/VVRzH31xEbjxEQmjYAobWUkdYIiYxYYg8c+/9HrqUhAaFbvaE60lnOVzTrRbFMCZjNkmvGV6433NjjY2W1WzrgVHNkq0VtkxXZmqaUwyBTzv0Zd01TO4ZP3zP5b628we8vp/z9P5+DhAkSJAgUw1RyPpWCsN0wOmmUI1TK+Pkzf6IZiCQcbpppqZTO+NEYmicXPX1ZEEgUtpFEYxT97isz2hGoOF0UxTjdGgC2fFKb0Og4HRTLOP0xbVkfcYzUB3NQwmM07eTkCWm0yjj9ChUhXVSisbp2KRk/53aw5pOTqiGndNiptMpf2R9pLdDJRw6ZTBOZ2Rkcxu+PAhAnQuJ5qFcjdNFv2V1Gl2+me8FsBpAJlTAoZNd4zTo9xTWR0bS6/a1GLI2ANEwO4zTGqbTVb9lPcNDd9U2vW7IlgCIgNnROD1pHCl+yTo6hwYXVr60w5AtABAOs6Nx2iSzOdk7rlycX/b0VkN2pfk3KqIQplOjjKyt/dIfibk1zxuyKwCEwuzxjum0R0a27O0LpxMy7Bt9dmNzJ6XCbgpnnDwysqWucyfjFq14zJBNBxACM1PVQ5GM0/sysiV7Tw/EJKetM2TTYHZK3qNZjNNnMrJFu0/0R8xJqTFkF8DsON10i6bTERnZgpZjfdbo+LUAHgQwD2bHzilZ0+kHGdm8nf2fWKyRVQAeAJAIs+P00kJNp5MysrkNfT0WS1glgAoACTA75V5KZzr9LiObveNwl7FeywHEw+yUc8phOv0plXi2dLkMWQ3ALJgdxqlMNvEsrXO1GrJ2JRLPFAmrkXh8CE2rbdro6PhrUGZK29svizuyUtwtpuW84sdfcBwc9H8d/yP+MhQiFECOkE7MrnrW9s6ls1LSnJpVaqFYANwnpOcsKX6qdP952b+PLpWaZSEAlgrpuDsyN5TsO3Nccnq/+3AbWaEQi4V0VOKi2uK2X6WumJpOH9q8pMYxZbBQSEfE31ZduPv4N5JrutehUxwUYr5IPGHRsWvzd33fK1npfpuX5kIhkkTysYRZH1rZeORjSekfHTqZPyb6ICpUAYulMueVzydqbk9m/GLnlAqFmA3gfrGuM7d2H5A8ss5qHroXChErrt5Cetkmz1syP+LHelBeyoNC3Ggko9VLntizS9NHhiXO6Sual0SUVIZI8V5FSKc+0tjg8Fwdkqi0+FDVUAgrgCIhfWdF/XbRM5Ko9CjTqQ4KMRPAKiGdUlr3ot096H+PWMGkNWM8aSXlr99sb798fjo8ebAAyBLSCem2urIDF36bDo9aQgBkjCWtBVkbSl3nfp7sOl72XMcbyvwPm4B7hHRMYuq6krZTA9cTXr6la79Sbzz+P2kl1RS9eeLotWSztn3Qacjmm785fn1uF0krPHZudWHrT1//Vzbn1d4eQ7ZYiWcPkyR5LF5G3LRmVfN3n47L5jUdPWy0ZMoA3IAA41aRtES8zH3tq0MFLQN9RrPNASAKAcrssaRlsVSGWaOrjP6T+VsyU5S0RGfxZkwTYoxqBwkC//gbNIgEXXRi6msAAAAASUVORK5CYII=">
                       <b>EXP/<%=expense.category%>/<%=expense.refNo%>/<%=expense.Date%></b>
                    </span>
                    <!-- <a  >Setup Location</a> -->
                    <button
                        class="navbar-toggler"
                        type="button"
                        data-bs-toggle="offcanvas"
                        data-bs-target="#offcanvasNavbar"
                        aria-controls="offcanvasNavbar"
                    >
                    <i class="bi bi-three-dots-vertical"></i>
                    </button>
                    <div
                        class="offcanvas offcanvas-end"
                        tabindex="-1"
                        id="offcanvasNavbar"
                        aria-labelledby="offcanvasNavbarLabel"
                    >
                        <div class="dash offcanvas-header bg-dark-subtle ">
                            <h5 class="offcanvas-title" id="offcanvasNavbarLabel">
                                Menu
                            </h5>
                            <button
                                type="button"
                                class="btn-close text-reset"
                                data-bs-dismiss="offcanvas"
                                aria-label="Close"
                            ></button>
                        </div>
                        <div class="offcanvas-body ">
                            <!-- uls -->
                            <ul class="nav nav-tabs d-flex  align-content-center  " id="myTab" role="tablist" >
                              <%-include('./partials/USER.ejs')%>
                               
                               </ul> 
                            <!-- <form class="d-flex">
                                <input
                                    class="form-control"
                                    type="search"
                                    placeholder="Search ware House"
                                    aria-label="Search"
                                />
                                <button class="btn btn-success" type="submit">
                                    Search
                                </button>
                            </form> -->
                            <!-- <hr> -->
                            <!--  -->
                        </div>
                    </div>
                </div>
            </nav>
            
           <!-- Nav tabs -->
          
        </header>

        <main class="pt-4 ">
            <!-- Tab panes -->
            <div class="container border shadow flex-wrap d-flex gap-1 p-3 mb-5  mt-5 bg-light-subtle">
              
              <form  class="row g-3 needs-validation " id="form"  >
                <div class=" d-flex justify-content-between">
                  
                      <!-- <h5>Register Payment</h5> -->
                     <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAACXBIWXMAAAsTAAALEwEAmpwYAAABj0lEQVR4nO2VwUrDQBCG9yWqb9DePSkIveyAh14Ec9jVi2QOPof2abx7KkJt00KCVqF489CTJLlZe3YlpVuWGLBNmo2t88MPYQd25tuZ3TBGIpH+nzw/9IZByM213ui95gXh7bqxRP3H6Njzow6zpUEQqcSeH3aHQdwc+rEz8KNYr68cC+Jm8q3XrQNs2owAVhR1IKARKiZ9gs3Tu5WcdeJZcWZLWwcAF1d7ILHNhfvMBc7KusRc4Awkjrhwb5Kcmyleug4XOAWJSrssADByzHOe41nh4kHil7mxCbDu2Pw2QpDKM8+dFyJpYfrkKwBQXODHiXNZy3H62M7a0NYIgQkh8XptAC7wJb1R/eBw7rIA6ov9MyBGOTrgfv4VAC5wmgPgZyt1grINGbkJACo228QIEYCsuANPb0dWDATAqAOKRkjSJcbK336gH5ncsR/Z/YOnJpPJ0p1uv3Dstd5Sap8vPW60ygMwi9AuGlNG8doEsLMd6HT7qVnuFY6NGxbvwNa/QkAAaK8DJBKJbYW+AX7aIYn4KzT3AAAAAElFTkSuQmCC"
                     width="40"
                     height="40"
                     >
    
                   <h5> Status :<%=expense.status%></h5>
                   
                  </div>
    
                  <div class="col-md-4">
                    <label for="billreferenceNo" class="form-label">EXPENSE TYPE</label>
                    <p class="form-control"><%=expense.category%></p>
                </div>
    
              <div class="col-md-4">
                  <label for="billreferenceNo" class="form-label">Raised By</label>
                  <p class="form-control"><%=expense.initiatorId%></p>
              </div>
               
                <%if(expense.status === "pending" &&  user.expenseApprover){%> 
                <div class="col-md-4">
                    <label for="BankAccount" class="form-label">DEBIT JOURNAL POSTING</label>
                    <select id="BankAccount" required class="form-select border" name="BankAccount">
                      <%if(Accounts.length > 0){%>
                      <option value="" >Choose...</option>
                      <%Accounts.forEach(account =>{%>
                        
                        <option value="<%=account.bankCode%>"><%=account.bankCode%></option>
                      <%})%>
    
                      <%}%>
                    </select>
                </div>
                <%}%>
                <!-- show if payment isnt registered  -->
    
                <div class="col-md-4">
                  <label for="date" class="form-label">PAYMENT DATE</label>
                  <h5 class="form-text"><%=expense.paymentDate%></h5>
                </div>
                
                <%if(expense.status === "pending" && user.expenseApprover){%> 
                  <div class="col-md-4">
                    <label for="date" class="form-label">PAYMENT DATE</label>
                    <input type="date" name="paymentDate" required id="date" class="form-control border" >
                  </div>
                  <div class="col-md-4">
                    <label for="date" class="form-label">PAYMENT RefNo</label>
                    <input type="text" name="PaymentRef" required id="date" class="form-control border" >
                  </div>
                <%}%>
               
                <div class="col-md-4">
                  <label for="PAYEE" class="form-label">PAYEE</label>
                  <p class="form-control"><%=expense.payee%></p>
              </div>
    
              <div class="col-md-4">
                <label for="BankAccount" class="form-label">CREDIT ACCOUNT NUMBER</label>
                <p class="form-control"><%=expense.payeebankAccount%></p>
            </div>
    
            <div class="col-md-4">
              <label for="BankName" class="form-label">BANK </label>
              <p class="form-control"><%=expense.payeeBankName%></p>
          </div>
              <div class="col-md-4">
                <label for="DriverNumber" class="form-label">ATTACHMENT</label>
                <a href="<%=expense.Attachment%>" target="_blank" rel="noopener noreferrer">See Attachment</a>
            </div>
            <div class="col-md-4">
              <label for="Amount" class="form-label">AMOUNT </label>
              <p class="form-control">₦<%=expense.Amount%></p>
            </div>
               <div class="col-md-4">
                <label for="remark" class="form-label">REMARKS</label>
                <p class="form-text" ><%=expense.remarks%></p>
            </div>
    
            <div class="col-md-4">
              <label for="BankAccount" class="form-label">DEBIT ACCOUNT</label>
              <p class="form-control"><%=expense.BankAccount%></p>
          </div>
    
          <div class="col-md-4">
            <label for="BankAccount" class="form-label">APPROVAL OFFICER</label>
            <p class="form-control"><%=expense.Accountant%></p>
        </div>
    
              <%if(expense.status === "pending" && user.expenseApprover ){%> 
                  <div class="col-md-4 d-flex justify-content-between flex-column p-2">
                    <label for="InvoiceNo" class="form-label "> All done!</label>
                    <input type="hidden" name="billId" value="<%=expense._id%>" hidden>
                    <input type="hidden" id="ACCOUNT" value="<%=user.firstName%> <%=user.lastName%>">
                    <button type="submit" class="btn btn-dark form-control" > POST EXPENSE</button>
                  </div>
              <%}%>
    
              </form>
               
            </div>
        </main>
        <footer>
            <!-- place footer here -->
            <div class="container-fluid fixed-bottom bg-dark-subtle ">
                <div class="row">
                    <div class="col-12">
                        <div class="row">
                            <div class="col-12">
                                <p class="text-center">
                                    BADE &copy; <script>
                                        document.write(new Date().getFullYear());
                                    </script>. All rights reserved.
                                </p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!-- end of footer -->
        </footer>
        <!-- Bootstrap JavaScript Libraries -->
        <script
            src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js"
            integrity="sha384-I7E8VVD/ismYTF4hNIPjVp/Zjvgyol6VFvRkX/vR+Vc4jQkC+hVqc2pM8ODewa9r"
            crossorigin="anonymous"
        ></script>

        <script
            src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.min.js"
            integrity="sha384-BBtl+eGJRgqQAUMxJ7pMwbEyER4l1g+O15P+16Ep7Q9Q+zqX6gSbd85u4mG4QzX+"
            crossorigin="anonymous"
        ></script>
        <script>
          const form = document.getElementById('form');
          form.addEventListener('submit', async(event) => {
           event.preventDefault();
          const AccountatntId =  document.getElementById('ACCOUNT').value
             const request =  await fetch( `/api/v1/Expense/edit/${form.billId.value}/${AccountatntId}`,{
             method: 'PATCH',
             body:JSON.stringify({
               Accountant:AccountatntId,//cfo id
               BankAccount:form.BankAccount.value,
               status:'Approved',
               paymentDate:form.paymentDate.value,
               PaymentRef:form.PaymentRef.value
             }),
             headers:{'Content-Type': 'application/json'}
           })
 
           const response = await request.json()
           alert(response.message || response.error)
 
           response.message? location.reload() : ''
 
          })
     </script>
    </body>
</html>
