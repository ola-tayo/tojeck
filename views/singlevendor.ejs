<!DOCTYPE html>
<html lang="en">
    <%-include('./partials/head.ejs')%>
    <style>
      .box {
  position: relative;
}
.ribbon {
  position: absolute;
  right: -5px; top: -20px;
  z-index: 1;
  overflow: hidden;
  width: 95px; height: 95px;
  text-align: right;
}
.ribbon span {
  font-size: 10px;
  font-weight: bold;
  color: #FFF;
  text-transform: uppercase;
  text-align: center;
  line-height: 20px;
  transform: rotate(45deg);
  -webkit-transform: rotate(45deg);
  width: 100px;
  display: block;
  background: #79A70A;
  background: linear-gradient(#9BC90D 0%, #79A70A 100%);
  box-shadow: 0 3px 10px -5px rgba(0, 0, 0, 1);
  position: absolute;
  top: 19px; right: -21px;
}
.ribbon span::before {
  content: "";
  position: absolute; left: 0px; top: 100%;
  z-index: -1;
  border-left: 3px solid #79A70A;
  border-right: 3px solid transparent;
  border-bottom: 3px solid transparent;
  border-top: 3px solid #79A70A;
}
.ribbon span::after {
  content: "";
  position: absolute; right: 0px; top: 100%;
  z-index: -1;
  border-left: 3px solid transparent;
  border-right: 3px solid #79A70A;
  border-bottom: 3px solid transparent;
  border-top: 3px solid #79A70A;
}
    </style>
    <body>
      <nav class="dash navbar bg-black">
        <div class="container-fluid">
          <span class="navbar-brand" onclick="history.back()"  title="Back">
            <img 
            width="30"
            hegith="30"
            src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAYAAAA6/NlyAAAACXBIWXMAAAsTAAALEwEAmpwYAAAEgklEQVR4nO2a/U/VVRzH31xEbjxEQmjYAobWUkdYIiYxYYg8c+/9HrqUhAaFbvaE60lnOVzTrRbFMCZjNkmvGV6433NjjY2W1WzrgVHNkq0VtkxXZmqaUwyBTzv0Zd01TO4ZP3zP5b628we8vp/z9P5+DhAkSJAgUw1RyPpWCsN0wOmmUI1TK+Pkzf6IZiCQcbpppqZTO+NEYmicXPX1ZEEgUtpFEYxT97isz2hGoOF0UxTjdGgC2fFKb0Og4HRTLOP0xbVkfcYzUB3NQwmM07eTkCWm0yjj9ChUhXVSisbp2KRk/53aw5pOTqiGndNiptMpf2R9pLdDJRw6ZTBOZ2Rkcxu+PAhAnQuJ5qFcjdNFv2V1Gl2+me8FsBpAJlTAoZNd4zTo9xTWR0bS6/a1GLI2ANEwO4zTGqbTVb9lPcNDd9U2vW7IlgCIgNnROD1pHCl+yTo6hwYXVr60w5AtABAOs6Nx2iSzOdk7rlycX/b0VkN2pfk3KqIQplOjjKyt/dIfibk1zxuyKwCEwuzxjum0R0a27O0LpxMy7Bt9dmNzJ6XCbgpnnDwysqWucyfjFq14zJBNBxACM1PVQ5GM0/sysiV7Tw/EJKetM2TTYHZK3qNZjNNnMrJFu0/0R8xJqTFkF8DsON10i6bTERnZgpZjfdbo+LUAHgQwD2bHzilZ0+kHGdm8nf2fWKyRVQAeAJAIs+P00kJNp5MysrkNfT0WS1glgAoACTA75V5KZzr9LiObveNwl7FeywHEw+yUc8phOv0plXi2dLkMWQ3ALJgdxqlMNvEsrXO1GrJ2JRLPFAmrkXh8CE2rbdro6PhrUGZK29svizuyUtwtpuW84sdfcBwc9H8d/yP+MhQiFECOkE7MrnrW9s6ls1LSnJpVaqFYANwnpOcsKX6qdP952b+PLpWaZSEAlgrpuDsyN5TsO3Nccnq/+3AbWaEQi4V0VOKi2uK2X6WumJpOH9q8pMYxZbBQSEfE31ZduPv4N5JrutehUxwUYr5IPGHRsWvzd33fK1npfpuX5kIhkkTysYRZH1rZeORjSekfHTqZPyb6ICpUAYulMueVzydqbk9m/GLnlAqFmA3gfrGuM7d2H5A8ss5qHroXChErrt5Cetkmz1syP+LHelBeyoNC3Ggko9VLntizS9NHhiXO6Sual0SUVIZI8V5FSKc+0tjg8Fwdkqi0+FDVUAgrgCIhfWdF/XbRM5Ko9CjTqQ4KMRPAKiGdUlr3ot096H+PWMGkNWM8aSXlr99sb798fjo8ebAAyBLSCem2urIDF36bDo9aQgBkjCWtBVkbSl3nfp7sOl72XMcbyvwPm4B7hHRMYuq6krZTA9cTXr6la79Sbzz+P2kl1RS9eeLotWSztn3Qacjmm785fn1uF0krPHZudWHrT1//Vzbn1d4eQ7ZYiWcPkyR5LF5G3LRmVfN3n47L5jUdPWy0ZMoA3IAA41aRtES8zH3tq0MFLQN9RrPNASAKAcrssaRlsVSGWaOrjP6T+VsyU5S0RGfxZkwTYoxqBwkC//gbNIgEXXRi6msAAAAASUVORK5CYII=">
           </span>
          <ul class="navbar-nav me-auto mb-2 mb-lg-0">
            <li class="nav-item dropdown">
              <h5>
                <a
                  class="nav-link breadcrumb-item active"
                  aria-current="page"
                  href="/"
                  role="button"
                  data-bs-toggle="dropdown"
                  aria-expanded="false"
                  style="color: #fff !important"
                >
                <%=vendor.Name%>
                </a>
              </h5>
            </li>
          </ul>
         
          <%-include('./partials/inactive.ejs')%>
        </div>
      </nav>
    <div class="container p-3">
      <!-- breadcrum
        <div class="d-flex gap-2">
            <a href="/VIRTUAL/Vendors/<%user._id%>">Vendors</a> /  <a href=''><%=vendor.Name%></a> 
        </div> -->
        <div class="row g-3 shadow p-3 m-3 box">
          <%if(!vendor.block_vendor){%>
            <div class="ribbon"><span>Activated</span></div>
          <%}%>
          <div class="d-flex justify-content-between align-items-center">
            <h3><%=vendor.Name%></h3>
          </div>
            <div  style="width: 12rem;">
                <img src="<%if(vendor.image){%>
                  <%= vendor.image %>
                  <%}else{%>
                     https://cdn.pixabay.com/photo/2019/08/11/18/59/icon-4399701_640.png
                  <%}%>
                  " alt="<%= vendor.Name %> Photo" class="card-img-top" alt="...">
            </div>
            <!-- FOR customer type -->

            <div class="col-md-6">
              <label for="Balance" class="form-label">Balance</label>
             <h5 >₦<%=vendor.Balance%></h5>
            </div>

            <div class="col-md-6">
              <label for="Balance" class="form-label">Customer Bouns</label>
             <h5 >₦<%=vendor.Bouns%></h5>
            </div>

            <div class="border-top">
              <h5>Vendor Infomation</h5>
              
              <div class="col-md-4">
                <label for="category" class="form-label">Vendor Relationship type</label>
                <select id="category" class="form-select">
                  <option class="bg-warning" value="<%=vendor.Categories%>"><%=vendor.Categories%> (Current)</option>
                  <option value='Retail'>Retail</option>
                  <option value="Wholesale">Wholesale</option>
                  <option value="dropship">dropship</option>
                </select>
              </div>
            </div>

            
             
            <div class="col-md-4">
                <label for="validationCustomEmail" class="form-label"> Email</label>
                <div class="input-group has-validation">
                    <a  href="mailto:<%=vendor.email%>" class="input-group-text" id="inputGroupPrepend">@</a>
                    <input type="text" class="form-control" id="validationCustomEmail"value="<%=vendor.email%>" required aria-describedby="inputGroupPrepend"> 
                  </div>
              </div>
              <div class="col-md-4">
                <label for="validationCustomertel" class="form-label">Telephone</label>
                <div class="input-group has-validation">
                  <a href="tel:+234<%=vendor.vendor_tel%>" class="input-group-text" id="inputGroupPrepend1">&phone;<a>
                  <input type="text" class="form-control" id="validationCustomertel" aria-describedby="inputGroupPrepend1" required value="<%=vendor.vendor_tel%>">
                </div>
              </div>
            <div class="col-md-6">
              <label for="Name" class="form-label">Name</label>
              <input type="text" class="form-control" id="Name" value="<%=vendor.Name%>">
            </div>
            <div class="col-12">
              <label for="street" class="form-label">Address </label>
              <input type="text" class="form-control" id="street" placeholder="Apartment, studio, or floor" value="<%=vendor.Address%>">
            </div>
           
           <div class="row border-bottom border-top p-2">
            <h5>Payment</h5>
            <div class="col-md-6">
              <label for="Bank_name" class="form-label">Bank</label>
              <input type="text" class="form-control" id="Bank_name" value="<%=vendor.Bank_name%>" placeholder=" Bank  Name " >
            </div>

            <div class="col-md-6">
              <label for="Account_name" class="form-label">Account Name</label>
              <input type="text" class="form-control" id="Account_name" value="<%=vendor.Account_name%>" placeholder="  Account Name" >
            </div>

            <div class="col-md-6">
              <label for="Account_num" class="form-label">Account Number</label>
              <input type="number" class="form-control" id="Account_num" value="<%=vendor.Account_num%>" placeholder=" Bank Account Number ">
            </div>
            
           </div>

            <div class="col-12 bor">
              <h5>Settings</h5>
              <div class="form-check">
                <input class="form-check-input" type="checkbox" id="gridCheck" <%if(vendor.NewsFeedSubscription){%>
                    checked="checked"
                    <%}%>>
                <label class="form-check-label" for="gridCheck">
                   Subscribe to Email Markerting list 
                </label>
              </div>
            </div>

            <div class="col-12">
              <div class="form-check">
                <input class="form-check-input" type="checkbox" id="block_vendor" <%if(vendor.block_vendor){%>
                    checked="checked"
                    <%}%>>
                <label class="form-check-label" for="block_vendor" title="using this feature will RESTRICT users from raising PO for <%=vendor.Name%>">
                   Block <%=vendor.Name%> ?
                </label>
              </div>
            </div>
            <div class="col-12">
              <button type="submit" data-id="<%=vendor._id%>"  id="update" class="btn btn-dark">Update <%=vendor.Name%></button>
             
            </div>
        </div>
    </div>
    <%-include('./partials/footer.ejs')%>
</body>
<script>
  // =================================================================
  //send pactch request and delete 
const update = document.getElementById('update');
update.addEventListener('click',async ()=>{
  const id = update.dataset.id;
  const Name = document.querySelector('input#Name').value
  const email = document.querySelector('input#validationCustomEmail').value
  const vendor_tel = document.querySelector('input#validationCustomertel').value
  const Address = document.querySelector('input#validationCustomEmail').value
  const Bank_name = document.querySelector('#Bank_name').value
  const Account_num = document.querySelector('input#Account_num').value
  const block_vendor = document.querySelector('input#block_vendor').checked
  const Account_name = document.querySelector('input#Account_name').value;
  const Category = document.getElementById("category")
  const Categories = Category.options[Category.selectedIndex].value;

  const url = `/api/v1/vendor/update/${id}`;

  const data = await fetch(url,{
    method:'PATCH',
    body: JSON.stringify({
      Name,
      vendor_tel,
      email,
      block_vendor,
      Account_name,
      Account_num,
      Categories,
      Bank_name,
      Address
    }),
    headers:{'Content-Type': 'application/json'}
  })

    const res = await data.json().then(json => {
        if (json){
        
          Notification.requestPermission().then((perm) =>{
                  if(perm ==='granted'){
                    new Notification('Bigbern Notification',{
                      body:json.result ? json.result : json.error,
                      icon:'/495670-removebg-preview.png',
                    })
                  }else{
                    alert(json.result ? json.result : json.error)
                  }
                })
                location.reload()
        }
      }
    )
})


</script>
</html>

