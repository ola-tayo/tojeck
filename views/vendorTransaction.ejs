
<!DOCTYPE html>
<html lang="en">
  <%-include('./partials/inactive.ejs')%>
  <%-include('./partials/head.ejs')%>
  <%-include('./partials/Notification.ejs')%>
<head>
  <meta charset="utf-8" />
  <link rel="apple-touch-icon" sizes="76x76" href="../assets/img/apple-icon.png">
  <link rel="icon" type="image/png" href="../assets/img/favicon.png">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
  <title>
    Bade DashBoard
  </title>
  <meta content='width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0, shrink-to-fit=no' name='viewport' />
  <!--     Fonts and icons     -->
  <link href="https://fonts.googleapis.com/css?family=Montserrat:400,700,200" rel="stylesheet" />
  <link href="https://maxcdn.bootstrapcdn.com/font-awesome/latest/css/font-awesome.min.css" rel="stylesheet">
  <!-- CSS Files -->
  <link href="/bootstrap.min.css" rel="stylesheet" />
  <link href="/paper-dashboard.css?v=2.0.1" rel="stylesheet" />
  <style>
      tbody td {
border:1px solid rgb(255, 153, 0);
font-size: 0.8rem !important;
font-family: 'Lucida Sans', 'Lucida Sans Regular', 'Lucida Grande', 'Lucida Sans Unicode', Geneva, Verdana, sans-serif;
cursor: pointer;
transition-delay:1s;
padding: 1px;
text-align: center;
}
</style>
</head>

<body class=""  onload="getData()">
  <div class="wrapper ">
    <div class="sidebar" data-color="black" data-active-color="danger" style="overflow-y: hidden;">
      <div class="dash logo">
        
        <a href="" class="simple-text logo-normal" >
          <a class="navbar-brand" href="/api/v1/Dashboard/<%=user._id%>" title="Apps">
            <img src="data:image/png;base64,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" width="30" height="30">
          </a>
         
        </a>
      </div>
      <div class="sidebar-wrapper">
        <ul class="nav">
          <% if (user.isAdmin) { %>
           
          
          <li class="active-pro ">
            <a href="/api/v1/report">
              <p>Business At Glance</p>
            </a>
          </li>
          <li>
            <a href="/api/v1/CashFlow/report">
              <p>Cash Flow Statement</p>
            </a>
          </li>
          <li>
            <a href="/api/v1/Sale/Report">
              <p>Sales Report</p>
            </a>
          </li>
          <li>
            <a href="/api/v1/dispach/Report">
              <p>Dispatch Report</p>
            </a>
          </li>
          <li>
            <a href="/api/v1/LPO/Report">
              <p>LPO Report</p>
            </a>
          </li>
          
          <li class="active-pro">
            <a href="#">
              <p>ReOrder Report</p>
            </a>
          </li>
          <li class="active">
            <a href="/api/v1/vendor/report">
              <p>Vendor Transaction</p>
            </a>
          </li>
        <li class="active-pro">
          <a href="/api/v1/Bank/Transaction">
            <p>Bank Transaction</p>
          </a>
        </li>
        <li class="active-pro">
          <a href="#">
            <p>Promo item Report</p>
          </a>
        </li>
        <li class="active-pro">
          <a href="#">
            <p>Creditor Note </p>
          </a>
        </li>
        <li class="active-pro">
          <a href="#">
            <p>Debit Note Report</p>
          </a>
        </li>
        <li class="active-pro">
          <a href="#">
            <p>Sales By customer </p>
          </a>
        </li>
        <li class="active-pro">
          <a href="/api/v1/Expense/Report">
            <p>Expense Report</p>
          </a>
        </li>
        <li class="active-pro">
          <a href="#">
            <p>Sales Rep Report</p>
          </a>
        </li>
       
        <li class="active-pro">
          <a href="/api/v1/VAT/Reprot">
            <p>VAT Report</p>
          </a>
        </li>
        <% } %>
        <li>
          <a href="/api/v1/Debtor/Report">
            <p>Debtor Reprot</p>
          </a>
        </li>
        <li>
          <a href="/api/v1/StockReport">
            <p>Stock Balance </p>
          </a>
        </li>
        <li class="active-pro">
          <a href="/api/v1/customer/report">
            <p>Customer Ledger</p>
          </a>
        </li>
        <li class="active-pro">
          <a href="/api/v1/TGT/Achievement">
            <p>TGT Achievement </p>
          </a>
        </li>
        <li class="active-pro">
          <a href="/api/v1/SalesDump/Report">
            <p>Sales Dump </p>
          </a>
        </li>
      </ul>
      </div>
    </div>
    <div class="main-panel  h-100">
      <!-- Navbar -->
      <nav class="dash navbar navbar-expand-lg navbar-absolute fixed-top navbar-transparent">
        <div class="container-fluid">
          <div class="navbar-wrapper">
            <div class="navbar-toggle">
              <button type="button" class="navbar-toggler">
                <span class="navbar-toggler-bar bar1"></span>
                <span class="navbar-toggler-bar bar2"></span>
                <span class="navbar-toggler-bar bar3"></span>
              </button>
            </div>
            <a class="navbar-brand" href="javascript:;">Vendors Transactions</a>
          </div>
          <div class="collapse navbar-collapse justify-content-end" id="navigation">
            <form>
              <div class="input-group no-border">
                <input type="text" value="" class="form-control" placeholder="Search...">
                <div class="input-group-append">
                  <div class="input-group-text">
                    <img width="24" height="24" src="https://img.icons8.com/material-outlined/24/search--v1.png" alt="search--v1"/>
                  </div>
                </div>
              </div>
            </form>
            
          </div>
        </div>
      </nav>
      <!-- End Navbar -->
      <div class="content">
        
         
        <div class="row ">
          <div class="col-md-12 ">
            <div class="card bg-dark text-gray">
            <form id="dataForm">
              <div class="card-header d-flex justify-content-between w-100">
                <h5 class="card-title form-text text-warning">Select an Option</h5>
              </div>
              
              <div class="card-body d-flex justify-content-between align-items-center">

                <div class="col-md-2">
                  <i class="fa fa-calendar-o"></i>
                  <label for="pricelist" class="form-label">Start Period</label>
                  <input type="date" name="Startdate" id="date" required class="form-control border" >
              </div> 
              <span>
                  <img width="50" height="50" src="https://img.icons8.com/stickers/100/arrow.png" alt="arrow"/>
              </span>
              <!-- end date  -->
              <div class="col-md-2">
                <i class="fa fa-calendar-o"></i>
                  <label for="pricelist" class="form-label">End Period</label>
                  <input type="date" name="Enddate"  id="date"  required class="form-control border" >
              </div>

              <div >
                <input  type="radio" name="view" id="all" required data-value="all">
                <label for="all">View All</label>
            </div>

                <div >
                    <input  type="radio" name="view" id="selected" required data-value="selected">
                    <label for="selected">Selected Vendor</label>
                </div>

                <div id="customers"  class="col-md-4 d-none">
                  <label for="products" class="form-label">Vendor List </label>
                  <select class="form-select" name="WareHouse" >
                   <option >choose...</option>
                   <%if(vendors){%>
                    <%vendors.forEach((vendor)=>{%>
                    <option value="<%=vendor._id%>"><%=vendor.Name%></option>
                    <%})%>
                  <%}%>
                    </select>
              </div>
                <button class="btn btn-success p-2"><img width="14" height="14" src="https://img.icons8.com/material-outlined/24/search--v1.png" alt="search--v1"/></button>
              </div>
              </form>
              <div class="card-footer "><hr> 
                <h6 id="error"></h6>
                <!-- display result here -->
                <table class="w-100 d-none">
                    <span id="downloadBTN" class="d-none" onclick="document.getElementById('dowloadoption').style.display='block'" title="Export Result">
                        <img width="28" height="28" src="https://img.icons8.com/color/48/download--v1.png" alt="download--v1"/>
                    </span>
                    <thead>
                        <td class="border p-1">S/N</td>
                        <td  class="border p-1">VENDOR NAME</td>
                        <td  class="border p-1">DATE</td>
                        <td  class="border p-1">REFRENCE</td>
                        <td  class="border p-1">DEBIT</td>
                        <td  class="border p-1">CREDIT</td>
                        <td  class="border p-1">BALANCE(â‚¦)</td>
                    </thead>
                    <tbody id="payment"></tbody>
                </table>
              </div>
            </div>
          </div>
        </div>
    </div>
  </div>
   <!-- modal here -->
   <div id="dowloadoption" class="modal flex items-center flex-col justify-center gap-3 shadow">
    <div class="modal-body d-flex justify-content-center container">
      <div class="bg-light gap-3 p-3 rounded shadow  flex-column d-flex">
       <span title="close" onclick="document.getElementById('dowloadoption').style='none'">
         <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-x-square-fill" viewBox="0 0 16 16">
           <path d="M2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2H2zm3.354 4.646L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 1 1 .708-.708z"/>
         </svg>
       </span>
       <p>Choose a format to export result</p>
       <div >
        <input  type="radio" name="export"  id="RESET">
        <label for="RESET">RESET OPTION</label>
      </div>
      <div >
        <input  type="radio" name="export"  id="XLSX">
        <label for="XLSX">EXPORT TO XLSX</label>
      </div>

      <div>
        <input  type="radio" name="export"  id="PDF">
        <label for="PDF">DOWNLOAD AS PDF</label>
      </div>
     </div>
    </div>
  </div>
  <!-- ends here -->

</body>
<script src="https://cdn.jsdelivr.net/npm/dayjs@1/dayjs.min.js"></script>
  <script src="https://unpkg.com/jspdf-invoice-template@1.4.0/dist/index.js"></script>
  <script src="/filesaver.js" type="module"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.mini.min.js" integrity="sha512-NDQhXrK2pOCL18FV5/Nc+ya9Vz+7o8dJV1IGRwuuYuRMFhAR0allmjWdZCSHFLDYgMvXKyN2jXlSy2JJEmq+ZA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.29.4/moment-with-locales.min.js" integrity="sha512-42PE0rd+wZ2hNXftlM78BSehIGzezNeQuzihiBCvUEB3CVxHvsShF86wBWwQORNxNINlBPuq7rG4WWhNiTVHFg==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
  <script  >
     const formatter = new Intl.DateTimeFormat('en-us')
      let data = []
    const  dataForm = document.getElementById('dataForm')
    let invoice
    let customers 
    let Employee
    let wareHouse
    const getData = async ()=>{
      plsWait(true)
        const request = await fetch('/api/v1/Getfulldb',{
        method:'GET',
        headers:{'Content-Type': 'application/json'},
    })
        const response = await request.json()
        response ? plsWait(false) :''
        customers = response.customers
        Employee = response.Employee
        invoice = response.invoice
        wareHouse = response.WH

    //   select view customer
    var btns = document.getElementsByName('view')
             for(var i=0;i<btns.length;i++){
        
                btns[i].addEventListener('change',async (e)=>{
                if(e.target.dataset.value === 'selected'){
                    document.getElementById('customers').classList.remove('d-none')
                    dataForm.addEventListener('submit',async (e)=>{
                    e.preventDefault()

                    const generateDates = (to ,from) => {
                      const arr = [];
                    
                      while (from.getTime() <= to.getTime()) {
                        arr.push(dayjs(from).format("D-MMM-YYYY"));
                        from.setDate(from.getDate() + 1);
                      }
                    
                      return arr;
                    };

                      data = []
                      const selectedVendor = response.vendorBill.filter((bill)=>{
                        const dates = generateDates(new Date(dataForm.Enddate.value),new Date(dataForm.Startdate.value))
                        const formattedDate = dayjs(bill.PaymentDate).format("D-MMM-YYYY");
                        return bill.vendor.toString() === dataForm.WareHouse.value.toString() && dates.includes(formattedDate);
                      
                      })
                        renderDOm(selectedVendor)
                    })
                }else if(e.target.dataset.value === 'all'){
                  const generateDates = (to ,from) => {
                      const arr = [];
                    
                      while (from.getTime() <= to.getTime()) {
                        arr.push(dayjs(from).format("D-MMM-YYYY"));
                        from.setDate(from.getDate() + 1);
                      }
                    
                      return arr;
                    };
                    data = []
                    datatedData = response.vendorBill.filter((payment)=>{
                    const dates = generateDates(new Date(dataForm.Enddate.value),new Date(dataForm.Startdate.value),)
                    const formattedDate = dayjs(payment.PaymentDate).format("D-MMM-YYYY");
                    return dates.includes(formattedDate);
                  })
                    renderDOm(datatedData)
                }
                })
            }

       
    downloadBTN = document.getElementById('downloadBTN')

    const renderDOm = async (customers)=>{
        let count =  customers.length - customers.length + 1
        tHead = document.querySelector('table')
        // render result 
        if(customers ){
          downloadBTN.classList.remove('d-none')
        let tbody = document.getElementById('payment')
        document.getElementById('error').innerText = ''
        tbody.innerHTML =''
        tHead.classList.remove('d-none')
        customers.sort((a,b)=>{return a.createdAt - b.createdAt}).map(async(element)=>{
        let NameOfvendor = await response.vendor.filter((vendor) =>{return vendor._id.toString() === element.vendor.toString()}).map((vendor) => {return vendor.Name})
       
            //excell data
            data.push({VENDOR:NameOfvendor[0],DATE:formatter.format(new Date(element.PaymentDate)),REF:element.billReferenceNo,DR: element.dr ? element.Amount : 0,CR : element.cr ? element.Amount : 0,BALANCE:element.Balance})

        let tr = document.createElement('tr')
        let counter = document.createElement('td')
        let CustomerName = document.createElement('a')
        let CustomerType = document.createElement('td')
        // let location = document.createElement('td')
        let phone = document.createElement('td')
        let lastPayDate = document.createElement('td')
        let salesPerson = document.createElement('td')
        let Debt = document.createElement('td')
        // assign element to variable
        counter.innerText = `${count++}`
        
       
        CustomerName.innerText = NameOfvendor
        // CustomerName.href = `/api/v1/vendor/${element._id}/edit`
        CustomerType.innerText = formatter.format(new Date(element.PaymentDate))
        // location.innerText = 'hello'
        phone.innerText = element.billReferenceNo
        lastPayDate.innerText = element.dr ? element.Amount : 0
        salesPerson.innerText = element.cr ? element.Amount : 0
        Debt.innerText = element.Balance ? element.Balance : ''
        // add style 
        tr.classList.add('border')
        counter.classList.add('border')
        // append element to table body
        tr.appendChild(counter)
        tr.appendChild(CustomerName)
        tr.appendChild(CustomerType)
        // tr.appendChild(location)
        tr.appendChild(phone)
        tr.appendChild(lastPayDate) 
        tr.appendChild(salesPerson)
        tr.appendChild(Debt)
        tbody.append(tr)
    })
        }else{
            document.getElementById('error').innerText = "No Matching Data Found"
        }
    }
    
        const EXCEL_TYPE = 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8';
        const EXCEL_EXTENSION = '.xlsx';
        const XLSXDOWNLOAD = document.getElementById('XLSX')
        
        const  DownloadXLSX = async(data)=>{
        const worksheet = XLSX.utils.json_to_sheet(data);
            const workbook = {
                Sheets: {
                    'data' : worksheet
                },
                SheetNames: ['data']
            };
            const excelBuffer = XLSX.write(workbook, {bookType: 'xlsx', type: 'array'});
            saveAsExcel(excelBuffer, '');
        }
    

        XLSXDOWNLOAD.addEventListener('change',  async ()=>{
           await DownloadXLSX(data)
        })

        const saveAsExcel = (Buffer,filename)=>{
        const data = new Blob([Buffer],{type:EXCEL_TYPE})
        saveAs(data,filename+'Vendor Transaction' + EXCEL_EXTENSION)
        }

        // Download to pdf
        const DOWNLOADTOPDF = document.getElementById('PDF')
        DOWNLOADTOPDF.addEventListener('change',async (event)=>{
        var pdfObject = await jsPDFInvoiceTemplate.default( {
        outputType: jsPDFInvoiceTemplate.OutputType.Save,
        returnJsPDFDocObject: true,
        fileName: `Vendor Transaction`,
        orientationLandscape: false,
        compress: true,
        logo: {
        src: "/logo.jpg",
        type: 'JPG', //optional, when src= data:uri (nodejs case)
        width: 26.66, //aspect ratio = width/height
        height: 26.66,
        margin: {
            top: 0, //negative or positive num, from the current position
            left: 0 //negative or positive num, from the current position
        }
        },
        stamp: {
        inAllPages: true, //by default = false, just in the last page
        src: "/logo.jpg",
        type: 'JPG', //optional, when src= data:uri (nodejs case)
        width: 20, //aspect ratio = width/height
        height: 20,
        margin: {
            top: 0, //negative or positive num, from the current position
            left: 0 //negative or positive num, from the current position
        }
        },
        business: {
        name: "ALL CHANNELS DISTRIBUTORS NIG LTD",
        address: "CM/104 COMPLEX KARU NEW MARKET, KARU ABUJA ,",
        email: "(+234) 081584911682, ALLCHANNELDISTRIBUTION@YAHOO.COM",
        phone: "Group 3 Plaza, UK Bello Road, kasuwar gwari, Minna Niger State.",
        },
        contact: {
        label:``,
        name: `Vendor Transaction`,
        address: ``,
        phone: ``,
        email: ``,
        otherInfo:``,
        },
        invoice: {
        label:``,
        num: `` ,
        invDate: `Download date : ${moment().format('l')}`,
        invGenDate: ``,
        headerBorder: true,
        tableBodyBorder: true,
        header: [
          {
            title: "#",
            style: {
              width: 10
            }
          },
          {
            title: "Vendor",
            style: {
              width: 40
            }
          },
          { title: "Date"},
          { title: " Refrence",
            style: {
              width: 50
            }},
          { title: "DR"},
          { title: "CR"},
          { title: "Balance"},
        ],
        table: data.sort((a,b)=>{return a.createdAt - b.createdAt}).map((element,index)=>{
          return [index +1, element.VENDOR ? element.VENDOR:'',element.DATE?element.DATE:'', element.REF ? element.REF:'', element.DR , element.CR , element.BALANCE]
        })
         ,
        additionalRows: [{
            col1: 'Total:',
            col2: "145678",
            col3: '',
            style: {
                fontSize: 14 //optional, default 12
            }
        },
        {
            col1: 'VAT:',
            col2: "20",
            col3: '%',
            style: {
                fontSize: 10 //optional, default 12
            }
        },
        {
            col1: 'SubTotal:',
            col2: "116199.90",
            col3: 'ALL',
            style: {
                fontSize: 10 //optional, default 12
            }
        }],
        invDescLabel: ``,
        invDesc: ` `,
        // invTotal: `TOTAL DEBT :NGN${data.map(bill => {return bill.AMOUNT}).reduce((total , currentValue) => {return total + currentValue},0)}`,
        },
        footer: {
        text: "Powered by BADE",
        },
        pageEnable: true,
        pageLabel: "BADE ",
        }); //returns number of pages created
        })

      }
</script>


</html>
