
<!doctype html>
<html lang="en">
    <head>
        <title>BADE||APPRAISAL</title>
        <!-- Required meta tags -->
        <meta charset="utf-8" />
        <meta
            name="viewport"
            content="width=device-width, initial-scale=1, shrink-to-fit=no"
        />
        <link rel="icon" type="image/x-icon" href="https://allchannels.com.ng/BADES.jpg">
        <link rel="stylesheet" href="/sale.css" />
        <!-- Bootstrap CSS v5.2.1 -->
        <link
            href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
            rel="stylesheet"
            integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN"
            crossorigin="anonymous"
        />
        <style>
          .go-corner {
            display: flex;
            align-items: center;
            justify-content: center;
            position: absolute;
            width: 32px;
            height: 32px;
            overflow: hidden;
            top: 0;
            right: 0;
            background-color: #00838d;
            border-radius: 0 4px 0 32px;
            cursor: pointer;
          }
      
          .go-arrow {
            margin-top: -4px;
            margin-right: -4px;
            color: white;
            font-family: courier, sans;
          }
      
          /* card 2 */
          .card2 {
            display: block;
            top: 0px;
            position: relative;
            max-width: 262px;
            background-color: #f2f8f9;
            border-radius: 4px;
            padding: 32px 24px;
            margin: 12px;
            text-decoration: none;
            z-index: 0;
            overflow: hidden;
            border: 1px solid #f2f8f9;
            font-family: 'Dancing Script', cursive;
            font-family: 'Nova Square', sans-serif;
      
            &:hover {
              transition: all 0.2s ease-out;
              box-shadow: 0px 4px 8px rgba(38, 38, 38, 0.2);
              top: -4px;
              border: 1px solid #cccccc;
              background-color: white;
            }
      
            &:before {
              content: "";
              position: absolute;
              z-index: -1;
              top: -16px;
              right: -16px;
              background: #00838d;
              height: 32px;
              width: 32px;
              border-radius: 32px;
              transform: scale(2);
              transform-origin: 50% 50%;
              transition: transform 0.15s ease-out;
            }
          }
      
          &:hover:before {
            transform: scale(2.15);
          }
        </style>
    </head>
  
    <body>
        <header>
            <%-include('./partials/Notification.ejs')%> 
            <%-include('./partials/inactive.ejs')%>
            <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
            <!-- place navbar here -->
            <nav class="dash navbar navbar-light bg-light fixed-top" 
            style="background-color: rgb(173, 168, 105) !important">
                <div class="container-fluid">
                    <span  class="navbar-brand" >
                        <img 
                        onclick="history.back()"
                        width="30"
                        hegith="30"
                        src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAYAAAA6/NlyAAA
                        ACXBIWXMAAAsTAAALEwEAmpwYAAAEgklEQVR4nO2a/U/VVRzH31xEbjxEQmjYAobWUkdYIiYxYYg8c+/9HrqUhAaFbvaE60lnOVzTrRbFMCZjNkmvGV6433NjjY2W1WzrgVHNkq0VtkxXZmqaUwyBTzv0Zd01TO4ZP3zP5b628we8vp/z9P5+DhAkSJAgUw1RyPpWCsN0wOmmUI1TK+Pkzf6IZiCQcbpppqZTO+NEYmicXPX1ZEEgUtpFEYxT97isz2hGoOF0UxTjdGgC2fFKb0Og4HRTLOP0xbVkfcYzUB3NQwmM07eTkCWm0yjj9ChUhXVSisbp2KRk/53aw5pOTqiGndNiptMpf2R9pLdDJRw6ZTBOZ2Rkcxu+PAhAnQuJ5qFcjdNFv2V1Gl2+me8FsBpAJlTAoZNd4zTo9xTWR0bS6/a1GLI2ANEwO4zTGqbTVb9lPcNDd9U2vW7IlgCIgNnROD1pHCl+yTo6hwYXVr60w5AtABAOs6Nx2iSzOdk7rlycX/b0VkN2pfk3KqIQplOjjKyt/dIfibk1zxuyKwCEwuzxjum0R0a27O0LpxMy7Bt9dmNzJ6XCbgpnnDwysqWucyfjFq14zJBNBxACM1PVQ5GM0/sysiV7Tw/EJKetM2TTYHZK3qNZjNNnMrJFu0/0R8xJqTFkF8DsON10i6bTERnZgpZjfdbo+LUAHgQwD2bHzilZ0+kHGdm8nf2fWKyRVQAeAJAIs+P00kJNp5MysrkNfT0WS1glgAoACTA75V5KZzr9LiObveNwl7FeywHEw+yUc8phOv0plXi2dLkMWQ3ALJgdxqlMNvEsrXO1GrJ2JRLPFAmrkXh8CE2rbdro6PhrUGZK29svizuyUtwtpuW84sdfcBwc9H8d/yP+MhQiFECOkE7MrnrW9s6ls1LSnJpVaqFYANwnpOcsKX6qdP952b+PLpWaZSEAlgrpuDsyN5TsO3Nccnq/+3AbWaEQi4V0VOKi2uK2X6WumJpOH9q8pMYxZbBQSEfE31ZduPv4N5JrutehUxwUYr5IPGHRsWvzd33fK1npfpuX5kIhkkTysYRZH1rZeORjSekfHTqZPyb6ICpUAYulMueVzydqbk9m/GLnlAqFmA3gfrGuM7d2H5A8ss5qHroXChErrt5Cetkmz1syP+LHelBeyoNC3Ggko9VLntizS9NHhiXO6Sual0SUVIZI8V5FSKc+0tjg8Fwdkqi0+FDVUAgrgCIhfWdF/XbRM5Ko9CjTqQ4KMRPAKiGdUlr3ot096H+PWMGkNWM8aSXlr99sb798fjo8ebAAyBLSCem2urIDF36bDo9aQgBkjCWtBVkbSl3nfp7sOl72XMcbyvwPm4B7hHRMYuq6krZTA9cTXr6la79Sbzz+P2kl1RS9eeLotWSztn3Qacjmm785fn1uF0krPHZudWHrT1//Vzbn1d4eQ7ZYiWcPkyR5LF5G3LRmVfN3n47L5jUdPWy0ZMoA3IAA41aRtES8zH3tq0MFLQN9RrPNASAKAcrssaRlsVSGWaOrjP6T+VsyU5S0RGfxZkwTYoxqBwkC//gbNIgEXXRi6msAAAAASUVORK5CYII=">
                       <b>STAFF APPRAISAL MANAGEMENT</b>
                    </span>
                    <button
                        class="navbar-toggler"
                        type="button"
                        data-bs-toggle="offcanvas"
                        data-bs-target="#offcanvasNavbar"
                        aria-controls="offcanvasNavbar"
                    >
                    <i class="bi bi-three-dots-vertical"></i>
                    </button>
                    <div
                        class="offcanvas offcanvas-end"
                        tabindex="-1"
                        id="offcanvasNavbar"
                        aria-labelledby="offcanvasNavbarLabel"
                    >
                        <div class="dash offcanvas-header bg-dark-subtle ">
                            <h5 class="offcanvas-title" id="offcanvasNavbarLabel">
                                Menu
                            </h5>
                            <button
                                type="button"
                                class="btn-close text-reset"
                                data-bs-dismiss="offcanvas"
                                aria-label="Close"
                            ></button>
                        </div>
                        <div class="offcanvas-body ">
                            <!-- uls -->
                            <ul class="nav nav-tabs d-flex  align-content-center  " id="myTab" role="tablist" >
                              <%-include('./partials/USER.ejs')%>
                            
                                <li class="nav-item " role="presentation">
                                    <button
                                        class="nav-link "
                                        id="profile-tab"
                                        data-bs-toggle="tab"
                                        data-bs-target="#profile"
                                        type="button"
                                        role="tab"
                                        aria-controls="profile"
                                        aria-selected="false"
                                        title="Add New KPI"
                                    >
                                    New KPI
                                    </button>
                                </li>
                                
                                <%if(  user.isAdmin ){%>
                                <li class="nav-item active" role="presentation">
                                    <button
                                        class="nav-link active"
                                        id="messages-tab"
                                        data-bs-toggle="tab"
                                        data-bs-target="#messages"
                                        type="button"
                                        role="tab"
                                        aria-controls="messages"
                                        aria-selected="false"
                                        title="List of Locations"
                                    >
                                    Employee List  </button>
                                </li>
                                <%}%>
                               </ul> 
                               <form class="d-flex border">
                                <input type="text" id="searchLPOproducts" class="form-control " list="searchLPO" name="referenceNo" placeholder="Search Employee List" />
                                <datalist id="searchLPO" >
                                <!-- display options for Bills -->
                               
                                </datalist>
                                <button class="btn btn-success" type="submit">
                                    Search
                                </button>
                            </form>
                            <script>
                               const searchLPOproducts = document.getElementById("searchLPOproducts")
                               searchLPOproducts.addEventListener('change',async(event)=>{
                                plsWait(true) 
                            setTimeout(()=>{
                              plsWait(false)
                            },3000)
                            // location.assign(`/api/v1/Purchase/bill/${event.target.value}/`)
                            })      
                            </script>
                        <h6>List of KPI</h6>
                            <ul class="list-group list-group-flush">
                              <%if(results.KPI.length > 0){%>
                                <div class="list-group">
                                <%results.KPI.forEach(kpi=>{%>
                                  <!-- Hover added -->
                                    <a class="list-group-item list-group-item-action"
                                      ><%= kpi.name %></a >
                                    <%})%>
                                  </div>
                              <%}else{%>
                                  <i>Nothing to show</i>
                              <%}%>
                            </ul>
                        </div>
                    </div>
                </div>
            </nav>
            
           <!-- Nav tabs -->
          
        </header>

        <main class="pt-4 ">
            <!-- Tab panes -->
            <div class="tab-content mt-5 ">
           
                <div
                    class="tab-pane "
                    id="profile"
                    role="tabpanel"
                    aria-labelledby="profile-tab"
                >
                   <div class="container-fluid ">
                   <!-- display all appraisal here  -->
                   <form class="m-3 w-auto  d-flex flex-column border shadow p-3" id="locationForm">
                    <h5>Create New KPI</h5>
                 <label for="" class="form-label">Name</label>
                 <small id="helpId" class="form-text text-muted">Enter Name of KPI</small>
                 <input
                     type="text"
                     class="form-control w-50 "
                     name="Name"
                     aria-describedby="helpId"
                     placeholder="Type a name for this KPI"
                     required
                 />
                 <br>
                 <button
                     type="submit"
                     class="btn btn-primary w-25"
                 >
                     Add New
                 </button>
                 
                </form>
                   <!-- ends here -->
                   </div>
                </div>
                <div
                    class="tab-pane active"
                    id="messages"
                    role="tabpanel"
                    aria-labelledby="messages-tab"
                >
                   <div class="overflow-hidden flex-wrap d-flex gap-1 p-3 mb-5 ">
                  <!-- display all employee here  -->

                    <%if(results.Appraisal.length > 0){%>
                    <% results.Appraisal.forEach((Employee)=> { %>
                    <div class="card2 m-1 mb-3 shadow rounded animate__bounceIn" style="width:13rem; border: <%if(Employee.status === 'active'){%>
                              2px solid skyblue
                            <%}%>;" title="<%=Employee.firstName%>">
                      <div class="card-img-top justify-content-center d-flex p-2">
                        <img src="<%if(Employee.image){%>
                                        <%= Employee.image %>
                                        <%}else{%>
                                            https://cdn.pixabay.com/photo/2019/08/11/18/59/icon-4399701_640.png
                                        <%}%>
                                        " alt="No Photo uploaded"  width=130 height="130">
                                </div>
                            
                                <div class="card-body" style="overflow:hidden;
                                white-space:nowrap;
                                text-overflow:ellipsis;
                                max-width:150px;">
                                    <p class="card-title"><%= Employee.firstName.charAt(0).toUpperCase() %><%= Employee.firstName.substring(1,10) %>
                                      <%= Employee.lastName.charAt(0).toUpperCase() %><%= Employee.lastName.substring(1,10) %> </p> 
                                      <% if (Employee.Appraisal) { %>
                                        <a title="last Appraisal " href=" /api/v1/Appraisal/<%=Employee._id%>" class="badge bg-danger-subtle text-dark border shadow"><%=Employee.Appraisal %>  </a>
                                      <% } %>
                      </div>
                      <a href=' /api/v1/Appraisal/<%=Employee._id%>' class="go-corner">
                        <div class="go-arrow">
                          →
                        </div>
                      </a>
                    </div>
                    <% }) %>
                    <%}else{%>
                    <h2>No Employee to display</h2>
                    <%}%>
                    
                    
                  </div>
                </div>
               </div>
        </main>
        <footer style="z-index: 3 !important;">
          <!-- place footer here -->
          <div class="container-fluid fixed-bottom bg-dark-subtle ">
              <div class="row p-2">
                  <!-- for next and filter -->
                  <div class="contaner d-flex justify-content-between">
                    <div>
                             <!-- next and prev btn -->
                             <button class="btn me-2 btn-dark"  <%if(!results.Previous){%>
                disabled
                <%}%>
                <%if(results.Previous){%>
                  class="btn btn-dark shadow-sm me-2"
                  onclick="location.assign('/api/v1/Appraisals/Management/<%=user._id%>/?page=<%=results.Previous.page%>&limit=10&category=<%=results.currentCat%>')"
                <%}%>
                >prev
                </button>
                <button 
                class="btn me-2 btn-dark"
                <%if(!results.next){%>
                  disabled
                  <%}%>
                  <%if(results.next){%>
                    class="btn btn-dark shadow-sm me-2"
                    onclick="location.assign('/api/v1/Appraisals/Management/<%=user._id%>/?page=<%=results.next.page%>&limit=10&category=<%=results.currentCat%>')"
                <%}%>
                >Next</button>
                     <!--  -->
                    </div>
 
                    <div>
                     
                    </div>
                          <div class="row">
                            <div class="col-12">
                                <p class="text-center">
                                    BADE &copy; <script>
                                        document.write(new Date().getFullYear());
                                    </script>. All rights reserved.
                                </p>
                            </div>
                        </div>
                     </div>
              </div>
          </div>
          <!-- end of footer -->
          <input type="hidden" id="Signature" value="<%=user.Signature%>">
      </footer>
        <!-- Bootstrap JavaScript Libraries -->
        <script
            src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js"
            integrity="sha384-I7E8VVD/ismYTF4hNIPjVp/Zjvgyol6VFvRkX/vR+Vc4jQkC+hVqc2pM8ODewa9r"
            crossorigin="anonymous"
        ></script>

        <script
            src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.min.js"
            integrity="sha384-BBtl+eGJRgqQAUMxJ7pMwbEyER4l1g+O15P+16Ep7Q9Q+zqX6gSbd85u4mG4QzX+"
            crossorigin="anonymous"
        ></script>
         <!-- The core Firebase JS SDK is always required and must be listed first -->
    <script src="https://www.gstatic.com/firebasejs/7.13.1/firebase-app.js"></script>
    <!-- TODO: Add SDKs for Firebase products that you want to use -->
    <script src="https://www.gstatic.com/firebasejs/7.13.1/firebase-storage.js"></script>
    <script type="module" src="/ImageUpload.js"></script>
    <script>
      //get the form id for submit button
      const locationForm = document.getElementById("locationForm");
      locationForm.addEventListener("submit",async (e)=>{
          e.preventDefault();
          plsWait(true)
          const request = await fetch("/api/v1/KPI/create",{
              method:"POST",
              body:JSON.stringify({
                  name:locationForm.Name.value
              }),
              headers:{'Content-Type': 'application/json'}
          });

          const response = await request.json();
          if(response.message){
            ShowServerResponse(response.message);
              locationForm.reset();
              plsWait(false)
          }else{
            serverError(response.error);
              plsWait(false);
          }
      })
  </script>
    </body>
</html>
